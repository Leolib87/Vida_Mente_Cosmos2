<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Avanzado de Financiamiento CTCI Chile</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.6.2/fuse.min.js"></script>
    <style>
        :root {
            --primary: #818cf8;
            --primary-dark: #6366f1;
            --secondary: #22d3ee;
            --danger: #f87171;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #0a0a0a;
            color: #e5e7eb;
            overflow-x: hidden;
            margin: 0;
        }

        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .glassmorphism {
            background: rgba(17, 24, 39, 0.8);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .filter-btn.active {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 0 15px rgba(129, 140, 248, 0.4);
        }

        .tab-link {
            transition: var(--transition);
            border-bottom: 2px solid transparent;
        }
        .tab-link.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .funding-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            border-color: var(--primary);
        }

        .modal {
            display: none;
            animation: fadeIn 0.3s ease;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .modal-content {
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1f2937;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        .tab-link:focus, .filter-btn:focus, .funding-card:focus, .reset-filters:focus, .search-input:focus, .suggestion-item:focus, .search-type-select:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        .search-box {
            position: relative;
            margin-bottom: 1rem;
        }
        .search-input {
            width: 100%;
            background: rgba(17, 24, 39, 0.7);
            border: 2px solid #374151;
            border-radius: 0.5rem;
            padding: 0.5rem 2.5rem 0.5rem 6rem;
            color: white;
            transition: border-color 0.3s;
        }
        .search-input:focus {
            border-color: var(--primary);
        }
        .search-clear {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: #6b7280;
            cursor: pointer;
            display: none;
        }
        .search-clear.visible {
            display: block;
        }
        .search-type-select {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(17, 24, 39, 0.7);
            border: none;
            color: white;
            padding: 0.2rem;
            border-radius: 0.25rem;
            z-index: 10;
            width: 5rem;
        }
        .suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(17, 24, 39, 0.9);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.5rem;
            margin-top: 0.5rem;
            max-height: 200px;
            overflow-y: auto;
            z-index: 20;
            display: none;
        }
        .suggestions.active {
            display: block;
        }
        .suggestion-item {
            padding: 0.5rem 1rem;
            color: #e5e7eb;
            cursor: pointer;
            transition: background 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .suggestion-item:hover, .suggestion-item:focus {
            background: var(--primary-dark);
        }
        .suggestion-type {
            font-size: 0.75rem;
            color: var(--secondary);
        }
        .highlight {
            background: var(--primary-dark);
            padding: 0 2px;
            border-radius: 2px;
        }
        .search-loading {
            position: absolute;
            right: 2.5rem;
            top: 50%;
            transform: translateY(-50%);
            display: none;
        }
        .search-loading.active {
            display: block;
        }
        .search-history {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 0.5rem;
            padding-top: 0.5rem;
        }
        .search-history-title {
            font-size: 0.75rem;
            color: #9ca3af;
            padding: 0.5rem 1rem;
        }
        .filter-section {
            margin-bottom: 2rem;
        }

        @media (max-width: 768px) {
            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
            .funding-grid {
                grid-template-columns: 1fr !important;
            }
            .modal-content {
                max-height: 80vh;
                padding: 1.5rem;
            }
            .search-type-select {
                width: 4rem;
                font-size: 0.75rem;
            }
            .search-input {
                padding-left: 5rem;
            }
        }
    </style>
</head>
<body class="text-gray-300">
    <canvas id="bg-canvas" aria-hidden="true"></canvas>

    <div class="container relative z-10 mx-auto p-4 md:p-8">
        <header class="glassmorphism rounded-2xl p-6 md:p-8 mb-8 shadow-2xl">
            <h1 class="text-3xl md:text-5xl font-bold bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] bg-clip-text text-transparent mb-2 text-center">Dashboard de Financiamiento CTCI</h1>
            <p class="text-center text-gray-400 text-lg">La plataforma definitiva para explorar fondos de investigación, innovación y emprendimiento en Chile.</p>
            
            <div class="stats grid grid-cols-2 md:grid-cols-4 gap-4 mt-8">
                <div class="stat-card bg-gray-900/50 p-4 rounded-xl text-center transition-transform duration-300 hover:scale-105 border border-white/10">
                    <div class="stat-number text-4xl font-bold bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] bg-clip-text text-transparent" id="totalFunds">0</div>
                    <div class="stat-label text-sm text-gray-400 uppercase tracking-wider mt-1"><i class="fas fa-layer-group mr-2"></i>Fondos Totales</div>
                </div>
                <div class="stat-card bg-gray-900/50 p-4 rounded-xl text-center transition-transform duration-300 hover:scale-105 border border-white/10">
                    <div class="stat-number text-4xl font-bold bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] bg-clip-text text-transparent" id="publicFunds">0</div>
                    <div class="stat-label text-sm text-gray-400 uppercase tracking-wider mt-1"><i class="fas fa-landmark mr-2"></i>Fondos Públicos</div>
                </div>
                <div class="stat-card bg-gray-900/50 p-4 rounded-xl text-center transition-transform duration-300 hover:scale-105 border border-white/10">
                    <div class="stat-number text-4xl font-bold bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] bg-clip-text text-transparent" id="privateFunds">0</div>
                    <div class="stat-label text-sm text-gray-400 uppercase tracking-wider mt-1"><i class="fas fa-handshake mr-2"></i>Fondos Privados</div>
                </div>
                <div class="stat-card bg-gray-900/50 p-4 rounded-xl text-center transition-transform duration-300 hover:scale-105 border border-white/10">
                    <div class="stat-number text-4xl font-bold bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] bg-clip-text text-transparent" id="maxAmount">0</div>
                    <div class="stat-label text-sm text-gray-400 uppercase tracking-wider mt-1"><i class="fas fa-coins mr-2"></i>Monto Máximo</div>
                </div>
            </div>
            <div class="mt-8 border-t border-white/10 pt-6">
                <div class="flex flex-wrap justify-center gap-4 md:gap-8" id="tab-navigation" role="tablist">
                    <button class="tab-link active font-semibold py-2 px-3 focus:outline-none" data-tab-filter="all" role="tab" aria-selected="true"><i class="fas fa-border-all mr-2"></i>Dashboard</button>
                    <button class="tab-link font-semibold py-2 px-3 focus:outline-none" data-tab-filter="publico" role="tab" aria-selected="false"><i class="fas fa-landmark mr-2"></i>Públicos</button>
                    <button class="tab-link font-semibold py-2 px-3 focus:outline-none" data-tab-filter="regional" role="tab" aria-selected="false"><i class="fas fa-map-marked-alt mr-2"></i>Regionales</button>
                    <button class="tab-link font-semibold py-2 px-3 focus:outline-none" data-tab-filter="privado" role="tab" aria-selected="false"><i class="fas fa-handshake mr-2"></i>Privados</button>
                    <button class="tab-link font-semibold py-2 px-3 focus:outline-none" data-tab-filter="educacion" role="tab" aria-selected="false"><i class="fas fa-graduation-cap mr-2"></i>Educación y Cultura</button>
                    <button class="tab-link font-semibold py-2 px-3 focus:outline-none" data-tab-filter="medioambiente" role="tab" aria-selected="false"><i class="fas fa-leaf mr-2"></i>Medioambiente</button>
                    <button class="tab-link font-semibold py-2 px-3 focus:outline-none" data-tab-filter="internacional" role="tab" aria-selected="false"><i class="fas fa-plane-departure mr-2"></i>Internacionales</button>
                </div>
            </div>
        </header>

        <div class="main-content grid grid-cols-1 lg:grid-cols-4 gap-8">
            <aside class="filters lg:col-span-1 glassmorphism rounded-2xl p-6 shadow-2xl h-fit sticky top-8">
                <h2 class="text-2xl font-bold mb-6 text-white flex items-center"><i class="fas fa-filter mr-3 text-[var(--primary)]"></i>Filtros</h2>
                
                <div class="filter-section">
                    <div class="search-box relative">
                        <select class="search-type-select" id="searchType" aria-label="Seleccionar tipo de búsqueda">
                            <option value="all">Todo</option>
                            <option value="name">Nombre</option>
                            <option value="institution">Institución</option>
                            <option value="focus">Enfoque</option>
                            <option value="requirements">Requisitos</option>
                        </select>
                        <input type="text" id="searchInput" placeholder="Buscar por nombre, institución, enfoque..." class="search-input" aria-label="Buscar fondos" autocomplete="off">
                        <i class="fas fa-spinner fa-spin search-loading" id="searchLoading" aria-hidden="true"></i>
                        <i class="fas fa-times search-clear" id="clearSearch" aria-label="Limpiar búsqueda"></i>
                        <div class="suggestions" id="suggestions" role="listbox" aria-label="Sugerencias de búsqueda"></div>
                    </div>
                </div>

                <div class="filter-section">
                    <h3 class="font-semibold mb-3 text-white flex items-center"><i class="fas fa-sitemap mr-2 text-[var(--primary)]"></i>Tipo de Fuente</h3>
                    <div class="filter-group flex flex-col gap-2" id="typeFilters" role="group" aria-label="Filtros por tipo de fuente">
                        <button class="filter-btn text-left w-full p-2 rounded-lg transition-colors hover:bg-[var(--primary)]/20 flex justify-between items-center focus:outline-none" data-filter="all"><span><i class="fas fa-globe w-6"></i>Todas</span> <span class="filter-count bg-gray-700 px-2 py-0.5 rounded-full text-xs">0</span></button>
                        <button class="filter-btn text-left w-full p-2 rounded-lg transition-colors hover:bg-[var(--primary)]/20 flex justify-between items-center focus:outline-none" data-filter="publico"><span><i class="fas fa-landmark w-6"></i>Público Nacional</span> <span class="filter-count bg-gray-700 px-2 py-0.5 rounded-full text-xs">0</span></button>
                        <button class="filter-btn text-left w-full p-2 rounded-lg transition-colors hover:bg-[var(--primary)]/20 flex justify-between items-center focus:outline-none" data-filter="regional"><span><i class="fas fa-map-marked-alt w-6"></i>Público Regional</span> <span class="filter-count bg-gray-700 px-2 py-0.5 rounded-full text-xs">0</span></button>
                        <button class="filter-btn text-left w-full p-2 rounded-lg transition-colors hover:bg-[var(--primary)]/20 flex justify-between items-center focus:outline-none" data-filter="privado"><span><i class="fas fa-handshake w-6"></i>Privado</span> <span class="filter-count bg-gray-700 px-2 py-0.5 rounded-full text-xs">0</span></button>
                        <button class="filter-btn text-left w-full p-2 rounded-lg transition-colors hover:bg-[var(--primary)]/20 flex justify-between items-center focus:outline-none" data-filter="internacional"><span><i class="fas fa-plane-departure w-6"></i>Internacional</span> <span class="filter-count bg-gray-700 px-2 py-0.5 rounded-full text-xs">0</span></button>
                    </div>
                </div>

                <div class="filter-section">
                    <h3 class="font-semibold mb-3 text-white flex items-center"><i class="fas fa-crosshairs mr-2 text-[var(--primary)]"></i>Enfoque</h3>
                    <div class="filter-group flex flex-col gap-2" id="focusFilters" role="group" aria-label="Filtros por enfoque">
                        <button class="filter-btn text-left w-full p-2 rounded-lg transition-colors hover:bg-[var(--primary)]/20 flex justify-between items-center focus:outline-none" data-filter="all"><span><i class="fas fa-star w-6"></i>Todos</span> <span class="filter-count bg-gray-700 px-2 py-0.5 rounded-full text-xs">0</span></button>
                        <button class="filter-btn text-left w-full p-2 rounded-lg transition-colors hover:bg-[var(--primary)]/20 flex justify-between items-center focus:outline-none" data-filter="investigacion"><span><i class="fas fa-flask w-6"></i>Investigación</span> <span class="filter-count bg-gray-700 px-2 py-0.5 rounded-full text-xs">0</span></button>
                        <button class="filter-btn text-left w-full p-2 rounded-lg transition-colors hover:bg-[var(--primary)]/20 flex justify-between items-center focus:outline-none" data-filter="innovacion"><span><i class="fas fa-lightbulb w-6"></i>Innovación</span> <span class="filter-count bg-gray-700 px-2 py-0.5 rounded-full text-xs">0</span></button>
                        <button class="filter-btn text-left w-full p-2 rounded-lg transition-colors hover:bg-[var(--primary)]/20 flex justify-between items-center focus:outline-none" data-filter="emprendimiento"><span><i class="fas fa-rocket w-6"></i>Emprendimiento</span> <span class="filter-count bg-gray-700 px-2 py-0.5 rounded-full text-xs">0</span></button>
                        <button class="filter-btn text-left w-full p-2 rounded-lg transition-colors hover:bg-[var(--primary)]/20 flex justify-between items-center focus:outline-none" data-filter="escalamiento"><span><i class="fas fa-chart-line w-6"></i>Escalamiento</span> <span class="filter-count bg-gray-700 px-2 py-0.5 rounded-full text-xs">0</span></button>
                        <button class="filter-btn text-left w-full p-2 rounded-lg transition-colors hover:bg-[var(--primary)]/20 flex justify-between items-center focus:outline-none" data-filter="educacion"><span><i class="fas fa-book-reader w-6"></i>Educación/Cultura</span> <span class="filter-count bg-gray-700 px-2 py-0.5 rounded-full text-xs">0</span></button>
                        <button class="filter-btn text-left w-full p-2 rounded-lg transition-colors hover:bg-[var(--primary)]/20 flex justify-between items-center focus:outline-none" data-filter="medioambiente"><span><i class="fas fa-leaf w-6"></i>Medioambiente</span> <span class="filter-count bg-gray-700 px-2 py-0.5 rounded-full text-xs">0</span></button>
                    </div>
                </div>
                
                <button class="reset-filters w-full py-2 bg-[var(--danger)]/80 hover:bg-[var(--danger)] rounded-lg font-semibold transition-all duration-300 hover:shadow-lg hover:shadow-[var(--danger)]/30 focus:outline-none" onclick="resetFilters()">
                    <i class="fas fa-sync-alt mr-2"></i>Restablecer Filtros
                </button>
            </aside>

            <main class="content lg:col-span-3 glassmorphism rounded-2xl p-6 shadow-2xl">
                <div class="content-header flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
                    <div class="results-info text-gray-400">
                        Mostrando <span id="resultsCount" class="font-bold text-[var(--primary)]">0</span> de <span id="totalCount">0</span> fondos
                    </div>
                    <select class="sort-dropdown bg-gray-900/70 border-2 border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-[var(--primary)]" id="sortDropdown" aria-label="Ordenar fondos">
                        <option value="name">Ordenar por Nombre</option>
                        <option value="amount">Ordenar por Monto</option>
                        <option value="type">Ordenar por Tipo</option>
                        <option value="cofinance">Ordenar por Cofinanciamiento</option>
                    </select>
                </div>

                <div class="funding-grid grid grid-cols-1 md:grid-cols-2 xl:grid-cols-2 2xl:grid-cols-3 gap-6" id="fundingGrid">
                </div>

                <div class="no-results text-center py-16 text-gray-500" id="noResults" style="display: none;">
                    <div class="no-results-icon text-6xl mb-4"><i class="fas fa-search"></i></div>
                    <h3 class="text-2xl font-bold text-white mb-2">No se encontraron resultados</h3>
                    <p>Intenta ajustar los filtros o términos de búsqueda</p>
                </div>
            </main>
        </div>
    </div>

    <div class="modal fixed inset-0 bg-black/80 backdrop-blur-sm z-50 items-center justify-content p-4" id="fundingModal" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
        <div class="modal-content glassmorphism rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto p-8 relative">
        </div>
    </div>

    <script>
         const fundingData = [
            { id: 1, name: "FONDECYT Regular 2025", type: "publico", category: "Público nacional", focus: ["investigacion"], description: "Financiamiento de proyectos de investigación individual de excelencia en base científico-tecnológica, con duración de 2 a 4 años.", amount: 57000000, amountText: "Máximo $57.000.000 anuales", cofinancing: 0, requirements: ["Investigador con trayectoria", "Proyecto de 2 a 4 años"], link: "https://anid.cl/concursos/concurso-de-proyectos-fondecyt-regular-2025/", institution: "ANID", duration: "2-4 años", deadline: "Anual: Ej. Abr–Jun 2025" },
            { id: 2, name: "FONDECYT Iniciación 2025", type: "publico", category: "Público nacional", focus: ["investigacion"], description: "Fomenta el desarrollo de investigación científica y tecnológica para nuevos investigadores, con proyectos de 2 a 3 años.", amount: 30000000, amountText: "Hasta $30.000.000 anuales", cofinancing: 0, requirements: ["Doctorado reciente", "Proyecto de 2 a 3 años"], link: "https://anid.cl/concursos/concurso-de-proyectos-fondecyt-de-iniciacion-en-investigacion-2025/", institution: "ANID", duration: "2-3 años", deadline: "Anual: Ej. Abr–Jul 2025" },
            { id: 3, name: "FONDECYT Postdoctorado 2025", type: "publico", category: "Público nacional", focus: ["investigacion"], description: "Apoyo a investigadores postdoctorales para desarrollar investigación independiente.", amount: 31164000, amountText: "$31.164.000 anuales (honorarios)", cofinancing: 0, requirements: ["Grado de Doctor", "Proyecto de 2 a 3 años"], link: "https://anid.cl/concursos/concurso-fondecyt-de-postdoctorado-2025/", institution: "ANID", duration: "2-3 años", deadline: "Anual: Ej. Ene–Abr 2025" },
            { id: 4, name: "Proyectos de Exploración 2025", type: "publico", category: "Público nacional", focus: ["investigacion"], description: "Financiamiento de investigación científico-tecnológica disruptiva y de alto potencial transformador.", amount: 80000000, amountText: "Máximo $80.000.000 anuales", cofinancing: 0, requirements: ["Proyectos de alto riesgo", "Investigación innovadora"], link: "https://anid.cl/concursos/concurso-de-proyectos-de-exploracion-2025/", institution: "ANID", duration: "1-2 años", deadline: "Anual: Ej. Abr–Ago 2025" },
            { id: 5, name: "Beca Doctorado Nacional 2025", type: "publico", category: "Público nacional", focus: ["investigacion", "educacion"], description: "Apoyo financiero para estudios de doctorado en programas acreditados chilenos.", amount: 7800000, amountText: "Manutención, matrícula, asignaciones", cofinancing: 0, requirements: ["Excelencia académica", "Aceptación en programa acreditado"], link: "https://anid.cl/concursos/beca-de-doctorado-nacional-ano-academico-2025/", institution: "ANID", duration: "Hasta 4 años", deadline: "Anual: Ej. Sep–Dic 2025" },
            { id: 6, name: "Doctorado Becas Chile 2025", type: "internacional", category: "Internacional", focus: ["investigacion", "educacion"], description: "Formación de capital humano avanzado en doctorados en el extranjero.", amount: 62000000, amountText: "Manutención, matrícula, seguro, pasajes", cofinancing: 0, requirements: ["Excelencia académica", "Aceptación en universidad extranjera"], link: "https://anid.cl/concursos/doctorado-becas-chile-2025/", institution: "ANID", duration: "Hasta 4 años", deadline: "Anual: Ej. Abr–Jul 2025" },
            { id: 7, name: "Beca Magíster Nacional 2025", type: "publico", category: "Público nacional", focus: ["investigacion", "educacion"], description: "Apoyo financiero para magíster en programas acreditados en Chile.", amount: 4800000, amountText: "Manutención, matrícula, asignaciones", cofinancing: 0, requirements: ["Excelencia académica", "Aceptación en programa acreditado"], link: "https://anid.cl/concursos/beca-de-magister-nacional-ano-academico-2025/", institution: "ANID", duration: "1-2 años", deadline: "Anual: Ej. Ago–Nov 2025" },
            { id: 8, name: "Magíster Becas Chile 2025", type: "internacional", category: "Internacional", focus: ["investigacion", "educacion"], description: "Financiamiento para magíster en el extranjero (máximo 100 becas).", amount: 40000000, amountText: "Manutención, matrícula, seguro, pasajes", cofinancing: 0, requirements: ["Excelencia académica", "Aceptación en programa extranjero"], link: "https://anid.cl/concursos/magister-becas-chile-2025/", institution: "ANID", duration: "1-2 años", deadline: "Anual: Ej. Oct 2024–Feb 2025" },
            { id: 9, name: "Concurso IDeA I+D 2025", type: "publico", category: "Público nacional", focus: ["investigacion", "innovacion"], description: "Cofinanciamiento de proyectos de I+D aplicada con componente científico para desarrollo de tecnologías.", amount: 227700000, amountText: "Máximo $227.700.000", cofinancing: 20, requirements: ["Colaboración con empresas", "TRL 4+"], link: "https://anid.cl/concursos/concurso-idea-id-2025/", institution: "ANID (FONDEF)", duration: "24 meses", deadline: "Anual: Ej. Ene–Mar 2025" },
            { id: 10, name: "IDeA I+D Tecnologías Avanzadas 2025", type: "publico", category: "Público nacional", focus: ["investigacion", "innovacion"], description: "Desarrollo y validación de soluciones de base científica tecnológica que requieren escalamiento.", amount: 660000000, amountText: "Máximo $660.000.000", cofinancing: 30, requirements: ["TRL≥3", "Proyectos de alto impacto"], link: "https://anid.cl/concursos/concurso-idea-id-tecnologias-avanzadas-2025/", institution: "ANID (FONDEF)", duration: "Hasta 4 años", deadline: "Cerró Nov 2024" },
            { id: 11, name: "Startup Ciencia 2025", type: "publico", category: "Público nacional", focus: ["emprendimiento", "innovacion"], description: "Incremento de emprendimientos de base científico-tecnológica.", amount: 134550000, amountText: "Máximo $134.550.000", cofinancing: 20, requirements: ["Emprendimiento científico-tecnológico", "Plan de negocio"], link: "https://anid.cl/concursos/startup-ciencia-2025/", institution: "ANID", duration: "12 meses", deadline: "Anual: Ej. Mar–May 2025" },
            { id: 12, name: "Crea y Valida", type: "publico", category: "Público nacional", focus: ["innovacion"], description: "Apoyo para el desarrollo de innovaciones que requieran I+D, desde prototipo hasta validación.", amount: 220000000, amountText: "Hasta $180M (ind.) / $220M (colab.)", cofinancing: 20, requirements: ["Empresa constituida", "Proyecto de I+D+i"], link: "https://www.corfo.cl/sites/cpp/convocatorias/crea_y_valida_idi", institution: "CORFO", duration: "24 meses", deadline: "Anual: Ej. Ene–Mar 2025" },
            { id: 13, name: "Innova Región", type: "regional", category: "Público regional", focus: ["innovacion"], description: "Financiamiento para proyectos innovadores con impacto en economías locales.", amount: 100000000, amountText: "Variable según región", cofinancing: 20, requirements: ["Pertinencia regional", "Proyectos de sostenibilidad"], link: "https://www.corfo.cl/sites/cpp/convocatorias/innova_region", institution: "CORFO", duration: "12-24 meses", deadline: "Anual por regiones: Ej. Feb–Abr 2025" },
            { id: 14, name: "Súmate a Innovar", type: "publico", category: "Público nacional", focus: ["innovacion"], description: "Cofinancia la contratación de profesionales para resolver desafíos de innovación en MIPYMES.", amount: 15000000, amountText: "Hasta $15.000.000", cofinancing: 20, requirements: ["Empresa MIPYME", "Plan de innovación"], link: "https://www.corfo.cl/sites/cpp/convocatorias/sumate_a_innovar", institution: "CORFO", duration: "Variable", deadline: "Anual: Ej. Mar–May 2025" },
            { id: 15, name: "Consolida y Expande Innovación", type: "publico", category: "Público nacional", focus: ["escalamiento"], description: "Financiamiento para innovaciones que impulsen sustentabilidad o desafíos estratégicos.", amount: 150000000, amountText: "Variable según proyecto", cofinancing: 40, requirements: ["Innovación validada", "Plan de escalamiento"], link: "https://www.corfo.cl/sites/cpp/convocatorias/consolida-y-expande", institution: "CORFO", duration: "18 meses", deadline: "Bianual: Ej. Dic 2024–Mar 2025" },
            { id: 16, name: "Ley I+D (Incentivo Tributario)", type: "publico", category: "Público nacional", focus: ["investigacion", "innovacion"], description: "Incentivo tributario para empresas que invierten en I+D.", amount: 0, amountText: "Hasta 52,55% de rebaja tributaria", cofinancing: 0, requirements: ["Empresa constituida", "Inversión en I+D"], link: "https://www.corfo.cl/sites/cpp/ley_de_id", institution: "CORFO", duration: "Variable", deadline: "Ventanilla abierta: Todo 2025" },
            { id: 17, name: "Semilla Inicia", type: "publico", category: "Público nacional", focus: ["emprendimiento", "innovacion"], description: "Apoyo a emprendimientos innovadores en etapa de idea, prototipo o solución sin ventas.", amount: 15000000, amountText: "Hasta $15.000.000 (75% cofinanciamiento)", cofinancing: 25, requirements: ["Emprendimiento sin ventas", "Plan de negocio"], link: "https://www.corfo.cl/sites/cpp/inf/semilla-inicia", institution: "CORFO", duration: "12 meses", deadline: "Anual: Ej. Oct 2024–Ene 2025" },
            { id: 18, name: "Semilla Expande", type: "publico", category: "Público nacional", focus: ["escalamiento"], description: "Apoyo a emprendimientos con modelo de negocio validado y primeras ventas.", amount: 45600000, amountText: "Hasta $25.6M (etapa 1) + $20M (etapa 2)", cofinancing: 25, requirements: ["Ventas iniciales", "Potencial de mercado"], link: "https://www.corfo.cl/sites/cpp/inf/semilla-expande", institution: "CORFO", duration: "12 meses", deadline: "Anual: Ej. Nov 2024–Feb 2025" },
            { id: 19, name: "Start-Up Chile - Build", type: "publico", category: "Público aceleradora", focus: ["emprendimiento"], description: "Pre-aceleración para startups en etapa temprana, desde prototipo hasta MVP validado.", amount: 10000000, amountText: "$10.000.000 CLP (equity-free)", cofinancing: 0, requirements: ["Equipo fundador", "Idea innovadora"], link: "https://startupchile.org/en/apply/build/", institution: "CORFO", duration: "4 meses", deadline: "Cohortes múltiples: Ej. Feb–Mar, Jun–Jul" },
            { id: 20, name: "Start-Up Chile - Ignite", type: "publico", category: "Público aceleradora", focus: ["emprendimiento"], description: "Para startups con producto funcional buscando product-market fit.", amount: 25000000, amountText: "$25.000.000 CLP (equity-free)", cofinancing: 0, requirements: ["Prototipo funcional", "Validación inicial"], link: "https://startupchile.org/en/apply/ignite/", institution: "CORFO", duration: "4 meses", deadline: "Cohortes múltiples: Ej. Feb–Mar, Jun–Jul" },
            { id: 21, name: "Start-Up Chile - Growth", type: "publico", category: "Público aceleradora", focus: ["escalamiento"], description: "Para startups establecidas en proceso de internacionalización.", amount: 75000000, amountText: "$75.000.000 CLP (equity-free)", cofinancing: 0, requirements: ["Ventas demostrables", "Plan de expansión"], link: "https://startupchile.org/en/apply/growth/", institution: "CORFO", duration: "8 meses", deadline: "Cohortes múltiples: Ej. Feb–Mar, Jun–Jul" },
            { id: 22, name: "GoGlobal", type: "publico", category: "Público nacional", focus: ["escalamiento"], description: "Apoya el ingreso a mercados internacionales (Perú, Colombia, México, EE.UU., España).", amount: 0, amountText: "Programa de softlanding (sin capital directo)", cofinancing: 0, requirements: ["Startup con tracción", "Interés en mercados específicos"], link: "https://www.corfo.cl/sites/cpp/programa-goglobal", institution: "CORFO", duration: "Variable", deadline: "Cerró 2024" },
            { id: 23, name: "Capital Semilla Emprende", type: "publico", category: "Público nacional", focus: ["emprendimiento"], description: "Ayuda a emprendedores que buscan iniciar un negocio y su puesta en marcha.", amount: 3500000, amountText: "$3.500.000 (subsidio no reembolsable)", cofinancing: 0, requirements: ["Sin inicio de actividades", "Plan de negocio"], link: "https://www.sercotec.cl/capital-semilla-emprende/", institution: "SERCOTEC", duration: "6 meses", deadline: "Anual por regiones: Ej. Mar–May 2025" },
            { id: 24, name: "Capital Abeja Emprende", type: "publico", category: "Público nacional", focus: ["emprendimiento"], description: "Apoya a mujeres emprendedoras que quieran iniciar un negocio.", amount: 3500000, amountText: "$3.500.000 (subsidio no reembolsable)", cofinancing: 0, requirements: ["Liderado por mujer", "Idea de negocio"], link: "https://www.sercotec.cl/capital-abeja-emprende/", institution: "SERCOTEC", duration: "6 meses", deadline: "Anual por regiones: Ej. Mar–May 2025" },
            { id: 25, name: "Crece", type: "publico", category: "Público nacional", focus: ["escalamiento"], description: "Entrega recursos para potenciar el crecimiento y acceder a nuevas oportunidades de negocio.", amount: 5000000, amountText: "$5.000.000 (subsidio no reembolsable)", cofinancing: 0, requirements: ["Empresa formalizada", "Potencial de crecimiento"], link: "https://www.sercotec.cl/crece/", institution: "SERCOTEC", duration: "6 meses", deadline: "Anual por regiones: Ej. Feb–Abr 2025" },
            { id: 26, name: "Fortalecimiento Gremial y Cooperativo", type: "publico", category: "Público nacional", focus: ["innovacion"], description: "Apoya el fortalecimiento de la asociatividad, la mejora de la capacidad de gestión y la generación de nuevos servicios en gremios y cooperativas.", amount: 10000000, amountText: "Hasta $10.000.000", cofinancing: 20, requirements: ["Organizaciones gremiales", "Proyectos asociativos"], link: "https://www.sercotec.cl/fortalecimiento-gremial-y-cooperativo/", institution: "SERCOTEC", duration: "Variable", deadline: "Anual: Ej. Mar–May 2025" },
            { id: 27, name: "Emprendamos Semilla / Básico / Avanzado", type: "publico", category: "Público nacional", focus: ["emprendimiento"], description: "Para personas con ideas de negocio o negocios en funcionamiento que necesitan apoyo.", amount: 750000, amountText: "Entre $400.000 - $750.000", cofinancing: 0, requirements: ["Registro Social de Hogares", "Idea de negocio"], link: "https://www.fosis.gob.cl/es/programas/emprendimiento/", institution: "FOSIS", duration: "6 meses", deadline: "Anual por regiones: Ej. Ene–Mar 2025" },
            { id: 28, name: "Programa de Desarrollo de Inversiones (PDI)", type: "publico", category: "Público nacional", focus: ["innovacion"], description: "Cofinancia inversiones para modernizar procesos productivos en el sector agrícola, pecuario o forestal.", amount: 5000000, amountText: "Hasta 90% del proyecto", cofinancing: 10, requirements: ["Agricultores INDAP", "Proyecto productivo"], link: "https://www.indap.gob.cl/plataforma-de-servicios/programa-desarrollo-de-inversiones-pdi", institution: "INDAP", duration: "Variable", deadline: "Anual" },
            { id: 29, name: "Mi Primer Negocio Rural", type: "publico", category: "Público nacional", focus: ["emprendimiento"], description: "Para jóvenes (18-40 años) con un primer emprendimiento silvoagropecuario formal.", amount: 3500000, amountText: "Hasta $3.5M inversión + capital trabajo", cofinancing: 10, requirements: ["Jóvenes 18-40 años", "Emprendimiento formal"], link: "https://www.indap.gob.cl/plataforma-de-servicios/mi-primer-negocio-rural", institution: "INDAP", duration: "Variable", deadline: "Anual" },
            { id: 30, name: "FONIDE", type: "publico", category: "Público nacional", focus: ["investigacion", "educacion"], description: "Promueve investigación externa en temas educativos para apoyar políticas públicas.", amount: 45000000, amountText: "Hasta $45.000.000 por proyecto", cofinancing: 0, requirements: ["Proyectos de investigación educativa", "Pertinencia para políticas públicas"], link: "https://fonide.mineduc.cl", institution: "MINEDUC", duration: "12 meses", deadline: "Abierto (Cierra Jun 2025)" },
            { id: 31, name: "Fondo de Desarrollo Institucional (FDI)", type: "publico", category: "Público nacional", focus: ["educacion"], description: "Apoya proyectos de mejora e innovación en áreas estratégicas de instituciones de educación superior.", amount: 500000000, amountText: "Variable (hasta $500M por proyecto)", cofinancing: 10, requirements: ["Instituciones de educación superior", "Proyectos de mejora"], link: "https://dfi.mineduc.cl/control-gestion/fdi/", institution: "MINEDUC", duration: "Variable", deadline: "Cerró 2024" },
            { id: 32, name: "FONIS", type: "publico", category: "Público nacional", focus: ["investigacion"], description: "Financia proyectos de investigación científica y tecnológica aplicada a problemas sanitarios.", amount: 70000000, amountText: "Hasta $70.000.000 por proyecto", cofinancing: 10, requirements: ["Pertinencia sanitaria", "Equipo multidisciplinario"], link: "https://anid.cl/concursos/proyectos-de-investigacion-y-desarrollo-en-salud-fonis-2025/", institution: "MINSAL / ANID", duration: "24 meses", deadline: "Anual: Ej. Feb–Abr 2025" },
            { id: 33, name: "FIA - Innovación Agraria", type: "publico", category: "Público nacional", focus: ["innovacion", "medioambiente"], description: "Promueve procesos de innovación en el sector silvoagropecuario y la cadena agroalimentaria.", amount: 150000000, amountText: "Variable según programa", cofinancing: 20, requirements: ["Proyectos agroalimentarios", "Sostenibilidad"], link: "https://www.fia.cl/convocatorias/", institution: "MINAGRI", duration: "Variable", deadline: "Cerró Nov 2024" },
            { id: 34, name: "Fondo de Protección Ambiental (FPA)", type: "publico", category: "Público nacional", focus: ["medioambiente"], description: "Financiamiento para iniciativas comunitarias de educación y protección ambiental.", amount: 6000000, amountText: "Hasta $6.000.000", cofinancing: 0, requirements: ["Organizaciones sin fines de lucro", "Proyectos comunitarios"], link: "https://fondos.mma.gob.cl", institution: "Min. Medio Ambiente", duration: "Variable", deadline: "Cerró Oct 2024" },
            { id: 35, name: "Fondo para el Reciclaje (FPR)", type: "publico", category: "Público nacional", focus: ["medioambiente"], description: "Apoyo a municipalidades para proyectos de economía circular y reciclaje.", amount: 14000000, amountText: "Hasta $14.000.000", cofinancing: 10, requirements: ["Municipalidades", "Gestión de residuos"], link: "https://fondos.mma.gob.cl", institution: "Min. Medio Ambiente", duration: "Hasta 24 meses", deadline: "Cerró Nov 2024" },
            { id: 36, name: "FONDART Nacional", type: "publico", category: "Público nacional", focus: ["educacion"], description: "Financiamiento para proyectos de creación, producción, y difusión artística en diversas disciplinas a nivel nacional.", amount: 10000000, amountText: "Variable", cofinancing: 20, requirements: ["Proyectos artísticos", "Impacto cultural"], link: "https://www.fondosdecultura.cl/fondart-nacional/", institution: "Min. de las Culturas", duration: "Variable", deadline: "Anual" },
            { id: 37, name: "Fondo del Libro y la Lectura", type: "publico", category: "Público nacional", focus: ["educacion"], description: "Apoya la creación literaria, la edición de libros, el fomento de la lectura y la internacionalización de la literatura chilena.", amount: 10000000, amountText: "Variable", cofinancing: 20, requirements: ["Proyectos literarios", "Fomento de lectura"], link: "https://www.fondosdecultura.cl/fondo-del-libro-y-la-lectura/", institution: "Min. de las Culturas", duration: "Variable", deadline: "Anual" },
            { id: 38, name: "Fondo de la Música", type: "publico", category: "Público nacional", focus: ["educacion"], description: "Fomenta la creación, producción, difusión y formación de música nacional en todos sus géneros.", amount: 10000000, amountText: "Variable", cofinancing: 20, requirements: ["Proyectos musicales", "Impacto cultural"], link: "https://www.fondosdecultura.cl/fondo-de-la-musica/", institution: "Min. de las Culturas", duration: "Variable", deadline: "Anual" },
            { id: 39, name: "Fondo Audiovisual", type: "publico", category: "Público nacional", focus: ["educacion"], description: "Apoya la producción, guion, distribución y difusión de obras audiovisuales chilenas (cine y TV).", amount: 10000000, amountText: "Variable", cofinancing: 20, requirements: ["Proyectos audiovisuales", "Impacto cultural"], link: "https://www.fondosdecultura.cl/fondo-audiovisual/", institution: "Min. de las Culturas", duration: "Variable", deadline: "Anual" },
            { id: 40, name: "PAOCC", type: "publico", category: "Público nacional", focus: ["educacion"], description: "Apoya a organizaciones culturales intermediateoras que colaboran con el ministerio en sus territorios.", amount: 10000000, amountText: "Variable", cofinancing: 20, requirements: ["Organizaciones culturales", "Colaboración territorial"], link: "https://www.fondosdecultura.cl/", institution: "Min. de las Culturas", duration: "Variable", deadline: "Anual" },
            { id: 41, name: "Impulso Chileno", type: "privado", category: "Privado filantrópico", focus: ["emprendimiento"], description: "Apoyo integral a emprendedores de todo el país para que hagan crecer sus negocios.", amount: 10000000, amountText: "Hasta $10.000.000 + capacitaciones", cofinancing: 0, requirements: ["Emprendedores", "Plan de negocio"], link: "https://impulsochileno.cl/", institution: "Fundación Luksic", duration: "Variable", deadline: "Anual" },
            { id: 42, name: "Concurso I+D para Innovar", type: "privado", category: "Privado filantrópico", focus: ["investigacion", "innovacion"], description: "Apoya proyectos innovadores de base tecnológica en recursos naturales y energía.", amount: 150000000, amountText: "Hasta UF 4.000 (ampliable a UF 8.000)", cofinancing: 25, requirements: ["TRL 3+", "Potencial de mercado"], link: "https://www.fcuc.cl/concursos/", institution: "Fundación Copec-UC", duration: "24 meses", deadline: "Cerró 2024" },
            { id: 43, name: "Concurso para Investigadores Jóvenes", type: "privado", category: "Privado filantrópico", focus: ["investigacion"], description: "Para investigadores menores de 40 años en I+D+i.", amount: 112500000, amountText: "UF 3.000 (ampliable a UF 6.000)", cofinancing: 25, requirements: ["Investigadores <40 años", "Proyecto I+D+i"], link: "https://www.fcuc.cl/concursos/", institution: "Fundación Copec-UC", duration: "24 meses", deadline: "Cerró 2024" },
            { id: 44, name: "Premios Avonni", type: "privado", category: "Privado filantrópico", focus: ["innovacion"], description: "Premio honorífico que visibiliza y reconoce los casos de éxito en innovación en Chile.", amount: 0, amountText: "Reconocimiento (sin monto directo)", cofinancing: 0, requirements: ["Innovaciones destacadas", "Postulación"], link: "https://www.avonni.cl/", institution: "Fundación ForoInnovación", duration: "N/A", deadline: "Anual" },
            { id: 45, name: "Horizon Europe 2025", type: "internacional", category: "Internacional", focus: ["investigacion", "innovacion"], description: "Programa marco de la UE para investigación e innovación. Chile puede participar en consorcios.", amount: 95500000000, amountText: "€95.5 mil millones (presupuesto total)", cofinancing: 30, requirements: ["Consorcios internacionales", "Proyectos de I+D+i"], link: "https://research-and-innovation.ec.europa.eu/funding/funding-opportunities/funding-programmes-and-open-calls/horizon-europe_en", institution: "Unión Europea", duration: "Variable", deadline: "Convocatorias periódicas: Ej. Todo 2025" },
            { id: 46, name: "Marie Skłodowska Curie Actions (MSCA)", type: "internacional", category: "Internacional", focus: ["investigacion"], description: "Becas para investigadores postdoctorales para movilidad internacional.", amount: 1400000, amountText: "Variable", cofinancing: 0, requirements: ["Investigadores postdoctorales", "Movilidad internacional"], link: "https://marie-sklodowska-curie-actions.ec.europa.eu/", institution: "Unión Europea", duration: "1-2 años", deadline: "Anual: Ej. Sep 2025" },
            { id: 47, name: "BID Lab", type: "internacional", category: "Internacional", focus: ["innovacion"], description: "Hub de innovación para el desarrollo de América Latina y el Caribe.", amount: 100000000, amountText: "Variable", cofinancing: 30, requirements: ["Proyectos innovadores", "Impacto regional"], link: "https://bidlab.org/en", institution: "BID", duration: "Variable", deadline: "Convocatorias periódicas" },
            { id: 48, name: "ECOS-ANID", type: "internacional", category: "Internacional", focus: ["investigacion"], description: "Cooperación científica Chile-Francia mediante apoyo a proyectos conjuntos de investigación.", amount: 10000000, amountText: "Financiamiento para movilidad", cofinancing: 0, requirements: ["Colaboración con equipo francés", "Proyectos de investigación"], link: "https://anid.cl/concursos/programa-de-cooperacion-cientifica-ecos-anid-2024/", institution: "ANID / Gobierno de Francia", duration: "2 años", deadline: "Anual: Ej. Feb–Abr 2025" },
            { id: 49, name: "Fulbright Chile", type: "internacional", category: "Internacional", focus: ["investigacion", "educacion"], description: "Programa de intercambio educativo Chile-Estados Unidos para postgrados.", amount: 50000000, amountText: "Estipendio, pasajes, gastos", cofinancing: 0, requirements: ["Ciudadanía chilena", "Excelencia académica"], link: "https://eca.state.gov/fulbright/country/chile", institution: "Fulbright / Gobierno de EE.UU.", duration: "1-4 años", deadline: "Anual: Ej. Oct 2024–Mar 2025" },
            { id: 50, name: "Becas para el Desarrollo", type: "internacional", category: "Internacional", focus: ["educacion"], description: "Becas de magíster para profesionales de América Latina y el Caribe en universidades chilenas.", amount: 4800000, amountText: "Variable", cofinancing: 0, requirements: ["Profesionales de América Latina", "Aceptación en programa chileno"], link: "https://www.agci.cl/becas/becas-para-extranjeros", institution: "AGCID", duration: "1-2 años", deadline: "Anual" },
            { id: 51, name: "FIC-R (Fondos Innovación Competitividad Regional)", type: "regional", category: "Público regional", focus: ["innovacion", "investigacion"], description: "Financia proyectos de I+D+i alineados con las estrategias de cada región.", amount: 300000000, amountText: "Variable (~$100–300M por proyecto)", cofinancing: 20, requirements: ["Pertinencia regional", "Alineado con Estrategia Regional"], link: "https://fic-r.subdere.gov.cl/", institution: "Gobiernos Regionales", duration: "12-24 meses", deadline: "Anual por región: Ej. Mar–Jun 2025" },
            { id: 52, name: "Concurso VIU (Valorización Investigación)", type: "publico", category: "Público nacional", focus: ["emprendimiento", "innovacion"], description: "Subsidio para proyectos universitarios de I+D con potencial comercial.", amount: 36000000, amountText: "Hasta $36.000.000", cofinancing: 20, requirements: ["Proyecto universitario", "Potencial comercial"], link: "https://anid.cl/concursos/concurso-valorizacion-de-la-investigacion-en-la-universidad-viu-2024/", institution: "ANID (Fondef)", duration: "12 meses", deadline: "Cerró May 2025" },
            { id: 53, name: "Fondo 'Somos Comunidad'", type: "privado", category: "Privado filantrópico", focus: ["educacion", "medioambiente"], description: "Fondo concursable para organizaciones locales en zonas de operación minera (educación, medioambiente).", amount: 1800000, amountText: "~$1.8M promedio por proyecto", cofinancing: 0, requirements: ["Organizaciones locales", "Zonas de operación minera"], link: "https://chile.angloamerican.com/es-es/programas-sociales/somos-comunidad", institution: "Anglo American", duration: "Variable", deadline: "Abierto (2024)" },
            { id: 54, name: "Fondos Concursables DICYT", type: "publico", category: "Público nacional", focus: ["investigacion"], description: "Apoyo a la comunidad investigadora de la USACH a través de diversos concursos internos.", amount: 10000000, amountText: "Variable", cofinancing: 0, requirements: ["Investigadores USACH", "Proyectos de investigación"], link: "https://dicyt.usach.cl/concursos-dicyt/", institution: "USACH", duration: "Variable", deadline: "Anual" },
            { id: 55, name: "Fondos Concursables VID", type: "publico", category: "Público nacional", focus: ["investigacion", "educacion"], description: "Más de 12 instrumentos para investigación, creación artística e innovación para la comunidad de la U. de Chile.", amount: 10000000, amountText: "Variable", cofinancing: 0, requirements: ["Comunidad U. de Chile", "Proyectos de I+D+i"], link: "https://uchile.cl/investigacion/investigacion/fondos-y-programas-vid", institution: "U. de Chile", duration: "Variable", deadline: "Anual" },
            { id: 56, name: "FONDART Regional", type: "regional", category: "Público regional", focus: ["educacion"], description: "Financiamiento para proyectos culturales y artísticos con impacto regional.", amount: 10000000, amountText: "Variable", cofinancing: 20, requirements: ["Proyectos culturales", "Impacto regional"], link: "https://www.fondosdecultura.cl/fondart-regional/", institution: "Min. de las Culturas", duration: "Variable", deadline: "Anual" },
            { id: 57, name: "Fondo de Desarrollo de las Artes Escénicas", type: "publico", category: "Público nacional", focus: ["educacion"], description: "Apoyo a proyectos de teatro, danza, circo y otras artes escénicas.", amount: 10000000, amountText: "Variable", cofinancing: 20, requirements: ["Proyectos de artes escénicas", "Impacto cultural"], link: "https://www.fondosdecultura.cl/", institution: "Min. de las Culturas", duration: "Variable", deadline: "Anual" },
            { id: 58, name: "Concurso Nacional de Proyectos de Investigación en Ciencia y Tecnología (ANID)", type: "publico", category: "Público nacional", focus: ["investigacion"], description: "Financiamiento para proyectos de investigación en ciencia y tecnología en diversas áreas.", amount: 100000000, amountText: "Variable", cofinancing: 0, requirements: ["Proyectos de investigación", "Excelencia científica"], link: "https://anid.cl/concursos/", institution: "ANID", duration: "Variable", deadline: "Anual" },
            { id: 59, name: "Fondo de Innovación para la Competitividad (FIC)", type: "regional", category: "Público regional", focus: ["innovacion"], description: "Apoyo a proyectos de innovación que promuevan el desarrollo regional.", amount: 300000000, amountText: "Variable", cofinancing: 20, requirements: ["Pertinencia regional", "Proyectos innovadores"], link: "https://www.subdere.gov.cl/fondo-de-innovaci%C3%B3n-para-la-competitividad-fic", institution: "Gobiernos Regionales", duration: "12-24 meses", deadline: "Anual por región" },
            { id: 60, name: "Programa de Apoyo a la Innovación (PAI)", type: "publico", category: "Público nacional", focus: ["innovacion"], description: "Financiamiento para proyectos de innovación tecnológica en empresas.", amount: 60000000, amountText: "Hasta $60.000.000", cofinancing: 30, requirements: ["Empresa constituida", "Proyecto de innovación"], link: "https://www.corfo.cl/sites/cpp/convocatorias/pai", institution: "CORFO", duration: "Variable", deadline: "Anual" },
            { id: 61, name: "Fondo de Fomento al Arte en la Educación (FAE)", type: "publico", category: "Público nacional", focus: ["educacion"], description: "Promueve proyectos artísticos en contextos educativos.", amount: 10000000, amountText: "Variable", cofinancing: 20, requirements: ["Proyectos educativos artísticos", "Impacto educativo"], link: "https://www.fondosdecultura.cl/", institution: "Min. de las Culturas", duration: "Variable", deadline: "Anual" },
            { id: 62, name: "Fondo de Innovación Social", type: "publico", category: "Público nacional", focus: ["innovacion"], description: "Apoyo a proyectos de innovación social con impacto comunitario.", amount: 10000000, amountText: "Variable", cofinancing: 20, requirements: ["Proyectos de impacto social", "Innovación"], link: "https://www.corfo.cl/", institution: "CORFO", duration: "Variable", deadline: "Anual" },
            { id: 63, name: "Concurso de Proyectos de Investigación en Patrimonio Cultural", type: "publico", category: "Público nacional", focus: ["investigacion", "educacion"], description: "Financiamiento para proyectos de investigación y conservación del patrimonio cultural chileno.", amount: 10000000, amountText: "Variable", cofinancing: 20, requirements: ["Proyectos de patrimonio", "Investigación cultural"], link: "https://www.fondosdecultura.cl/", institution: "Min. de las Culturas", duration: "Variable", deadline: "Anual" },
            { id: 64, name: "Fondo de Fortalecimiento de Organizaciones de Interés Público", type: "publico", category: "Público nacional", focus: ["innovacion"], description: "Apoyo a organizaciones sociales para proyectos de interés público.", amount: 4000000, amountText: "Hasta $4.000.000", cofinancing: 0, requirements: ["Organizaciones sociales", "Proyectos de interés público"], link: "https://fondos.gob.cl/", institution: "Min. Secretaría General de Gobierno", duration: "Variable", deadline: "Anual" },
            { id: 65, name: "Fondo de Iniciativas Locales", type: "publico", category: "Público nacional", focus: ["innovacion"], description: "Financiamiento para iniciativas comunitarias locales.", amount: 2000000, amountText: "Hasta $2.000.000", cofinancing: 0, requirements: ["Iniciativas comunitarias", "Impacto local"], link: "https://fondos.gob.cl/", institution: "Min. Secretaría General de Gobierno", duration: "Variable", deadline: "Anual" },
            { id: 66, name: "Fondo de Innovación Juvenil", type: "publico", category: "Público nacional", focus: ["innovacion"], description: "Apoyo a proyectos innovadores liderados por jóvenes (15-29 años).", amount: 2000000, amountText: "Hasta $2.000.000", cofinancing: 0, requirements: ["Jóvenes 15-29 años", "Proyectos innovadores"], link: "https://www.injuv.gob.cl/", institution: "INJUV", duration: "Variable", deadline: "Anual" },
            { id: 67, name: "Fondo de Desarrollo Productivo (FDP)", type: "publico", category: "Público nacional", focus: ["innovacion"], description: "Financiamiento para micro y pequeñas empresas para mejorar productividad.", amount: 6000000, amountText: "Hasta $6.000.000", cofinancing: 20, requirements: ["Micro y pequeñas empresas", "Mejora productiva"], link: "https://www.sercotec.cl/", institution: "SERCOTEC", duration: "Variable", deadline: "Anual" },
            { id: 68, name: "Fondo de Emprendimiento Juvenil", type: "publico", category: "Público nacional", focus: ["emprendimiento"], description: "Apoyo a emprendimientos liderados por jóvenes para iniciar o fortalecer negocios.", amount: 1500000, amountText: "Hasta $1.500.000", cofinancing: 0, requirements: ["Jóvenes 15-29 años", "Plan de negocio"], link: "https://www.injuv.gob.cl/", institution: "INJUV", duration: "Variable", deadline: "Anual" },
            { id: 69, name: "Fondo de Innovación para el Desarrollo Rural", type: "publico", category: "Público nacional", focus: ["innovacion"], description: "Apoyo a proyectos innovadores en el sector rural silvoagropecuario.", amount: 10000000, amountText: "Variable", cofinancing: 20, requirements: ["Proyectos rurales", "Innovación agropecuaria"], link: "https://www.indap.gob.cl/", institution: "INDAP", duration: "Variable", deadline: "Anual" },
            { id: 70, name: "Fondo de Investigación Pesquera y de Acuicultura (FIPA)", type: "publico", category: "Público nacional", focus: ["investigacion"], description: "Financiamiento para proyectos de investigación en pesca y acuicultura.", amount: 10000000, amountText: "Variable", cofinancing: 20, requirements: ["Proyectos de pesca/acuicultura", "Investigación aplicada"], link: "https://www.subpesca.cl/", institution: "Subsecretaría de Pesca y Acuicultura", duration: "Variable", deadline: "Anual" },
            { id: 71, name: "Fondo de Fomento a la Exportación", type: "publico", category: "Público nacional", focus: ["escalamiento"], description: "Apoyo a empresas para actividades de promoción de exportaciones.", amount: 10000000, amountText: "Variable", cofinancing: 20, requirements: ["Empresas exportadoras", "Promoción internacional"], link: "https://www.prochile.gob.cl/", institution: "ProChile", duration: "Variable", deadline: "Anual" },
            { id: 72, name: "Fondo de Desarrollo Local (FONDES)", type: "publico", category: "Público nacional", focus: ["innovacion"], description: "Financiamiento para iniciativas de desarrollo local en comunidades rurales.", amount: 5000000, amountText: "Hasta $5.000.000", cofinancing: 20, requirements: ["Comunidades rurales", "Proyectos de desarrollo"], link: "https://www.indap.gob.cl/", institution: "INDAP", duration: "Variable", deadline: "Anual" },
            { id: 73, name: "Fondo de Innovación para la Educación Superior", type: "publico", category: "Público nacional", focus: ["educacion"], description: "Apoyo a proyectos de innovación en instituciones de educación superior.", amount: 10000000, amountText: "Variable", cofinancing: 20, requirements: ["Instituciones de educación superior", "Proyectos innovadores"], link: "https://www.mineduc.cl/", institution: "MINEDUC", duration: "Variable", deadline: "Anual" }
        ];


        let scene, camera, renderer, points, lines;
        let fuse;

        function initThreeJS() {
            try {
                scene = new THREE.Scene();
                camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 1000);
                camera.position.z = 50;

                renderer = new THREE.WebGLRenderer({
                    canvas: document.getElementById("bg-canvas"),
                    alpha: true
                });
                renderer.setSize(window.innerWidth, window.innerHeight);

                const pointCount = 200;
                const positions = new Float32Array(pointCount * 3);
                const pointGeo = new THREE.BufferGeometry();
                for (let i = 0; i < pointCount; i++) {
                    positions[i * 3] = (Math.random() - 0.5) * 400;
                    positions[i * 3 + 1] = (Math.random() - 0.5) * 400;
                    positions[i * 3 + 2] = (Math.random() - 0.5) * 400;
                }
                pointGeo.setAttribute('position', new THREE.BufferAttribute(positions, 3));

                const spriteCanvas = document.createElement('canvas');
                spriteCanvas.width = 32;
                spriteCanvas.height = 32;
                const ctx = spriteCanvas.getContext('2d');
                ctx.beginPath();
                ctx.arc(16, 16, 14, 0, Math.PI * 2);
                ctx.fillStyle = '#ffffff';
                ctx.fill();
                const sprite = new THREE.Texture(spriteCanvas);
                sprite.needsUpdate = true;

                const pointMaterial = new THREE.PointsMaterial({
                    color: 0x818cf8,
                    size: 1.5,
                    map: sprite,
                    transparent: true,
                    opacity: 0.8
                });

                points = new THREE.Points(pointGeo, pointMaterial);
                scene.add(points);

                const lineGeo = new THREE.BufferGeometry();
                const maxConnections = 4;
                const maxDistance = 50;
                const linePositions = [];
                const pointPositions = pointGeo.attributes.position.array;

                for (let i = 0; i < pointCount; i++) {
                    const connections = [];
                    const x1 = pointPositions[i * 3];
                    const y1 = pointPositions[i * 3 + 1];
                    const z1 = pointPositions[i * 3 + 2];

                    for (let j = 0; j < pointCount; j++) {
                        if (i === j) continue;
                        const x2 = pointPositions[j * 3];
                        const y2 = pointPositions[j * 3 + 1];
                        const z2 = pointPositions[j * 3 + 2];
                        const distance = Math.sqrt(
                            (x2 - x1) ** 2 + (y2 - y1) ** 2 + (z2 - z1) ** 2
                        );
                        if (distance < maxDistance) {
                            connections.push({ index: j, distance });
                        }
                    }

                    connections.sort((a, b) => a.distance - b.distance);
                    connections.slice(0, maxConnections).forEach(conn => {
                        linePositions.push(x1, y1, z1);
                        linePositions.push(
                            pointPositions[conn.index * 3],
                            pointPositions[conn.index * 3 + 1],
                            pointPositions[conn.index * 3 + 2]
                        );
                    });
                }

                lineGeo.setAttribute('position', new THREE.Float32BufferAttribute(linePositions, 3));
                const lineMaterial = new THREE.LineBasicMaterial({
                    color: 0x22d3ee,
                    linewidth: 1,
                    opacity: 0.3,
                    transparent: true
                });

                lines = new THREE.LineSegments(lineGeo, lineMaterial);
                scene.add(lines);

                window.addEventListener("resize", onWindowResize, false);
                document.addEventListener('mousemove', onMouseMove, false);

                animate();
            } catch (error) {
                console.error('Error initializing Three.js:', error);
            }
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        let mouseX = 0, mouseY = 0;
        function onMouseMove(event) {
            mouseX = (event.clientX - window.innerWidth / 2) / 100;
            mouseY = (event.clientY - window.innerHeight / 2) / 100;
        }

        function animate() {
            if (!points || !lines) return;
            const pointPositions = points.geometry.attributes.position.array;
            const linePositions = lines.geometry.attributes.position.array;

            for (let i = 0; i < pointPositions.length; i += 3) {
                pointPositions[i + 1] += 0.02;
                if (pointPositions[i + 1] > 200) {
                    pointPositions[i + 1] = -200;
                    const pointIndex = Math.floor(i / 3);
                    const maxConnections = 4;
                    const maxDistance = 50;
                    const connections = [];
                    const x1 = pointPositions[i];
                    const y1 = pointPositions[i + 1];
                    const z1 = pointPositions[i + 2];

                    for (let j = 0; j < pointPositions.length / 3; j++) {
                        if (j === pointIndex) continue;
                        const x2 = pointPositions[j * 3];
                        const y2 = pointPositions[j * 3 + 1];
                        const z2 = pointPositions[j * 3 + 2];
                        const distance = Math.sqrt(
                            (x2 - x1) ** 2 + (y2 - y1) ** 2 + (z2 - z1) ** 2
                        );
                        if (distance < maxDistance) {
                            connections.push({ index: j, distance });
                        }
                    }

                    connections.sort((a, b) => a.distance - b.distance);
                    const lineStartIndex = pointIndex * maxConnections * 6;
                    for (let j = 0; j < maxConnections; j++) {
                        const lineIndex = lineStartIndex + j * 6;
                        if (j < connections.length) {
                            linePositions[lineIndex] = x1;
                            linePositions[lineIndex + 1] = y1;
                            linePositions[lineIndex + 2] = z1;
                            linePositions[lineIndex + 3] = pointPositions[connections[j].index * 3];
                            linePositions[lineIndex + 4] = pointPositions[connections[j].index * 3 + 1];
                            linePositions[lineIndex + 5] = pointPositions[connections[j].index * 3 + 2];
                        } else {
                            linePositions[lineIndex] = linePositions[lineIndex + 3] = 0;
                            linePositions[lineIndex + 1] = linePositions[lineIndex + 4] = 0;
                            linePositions[lineIndex + 2] = linePositions[lineIndex + 5] = 0;
                        }
                    }
                }
            }

            points.geometry.attributes.position.needsUpdate = true;
            lines.geometry.attributes.position.needsUpdate = true;

            points.rotation.y += 0.0005;
            lines.rotation.y += 0.0005;
            camera.position.x += (mouseX - camera.position.x) * 0.05;
            camera.position.y += (-mouseY - camera.position.y) * 0.05;
            camera.lookAt(scene.position);

            renderer.render(scene, camera);
            requestAnimationFrame(animate);
        }

        document.addEventListener('DOMContentLoaded', function() {
            initThreeJS();
            initFuse();
            updateStats();
            renderFundingCards(fundingData, '');
            setupEventListeners();
            updateFilterCounts();
            document.querySelector('#tab-navigation .tab-link[data-tab-filter="all"]').classList.add('active');
            document.querySelector('#typeFilters .filter-btn[data-filter="all"]').classList.add('active');
            document.querySelector('#focusFilters .filter-btn[data-filter="all"]').classList.add('active');
        });

        function initFuse() {
            const options = {
                includeScore: true,
                threshold: 0.3,
                keys: ['name', 'description', 'institution', 'focus', 'requirements']
            };
            fuse = new Fuse(fundingData, options);
        }

        function setupEventListeners() {
            const searchInput = document.getElementById('searchInput');
            const searchType = document.getElementById('searchType');
            const clearSearch = document.getElementById('clearSearch');
            const searchLoading = document.getElementById('searchLoading');
            const suggestions = document.getElementById('suggestions');

            document.getElementById('tab-navigation').addEventListener('click', (e) => {
                const tabButton = e.target.closest('.tab-link');
                if (tabButton) {
                    document.querySelectorAll('#tab-navigation .tab-link').forEach(btn => {
                        btn.classList.remove('active');
                        btn.setAttribute('aria-selected', 'false');
                    });
                    tabButton.classList.add('active');
                    tabButton.setAttribute('aria-selected', 'true');
                    filterFunds();
                }
            });

            const debouncedSearch = debounce(() => {
                searchLoading.classList.add('active');
                setTimeout(() => {
                    filterFunds();
                    updateSuggestions();
                    clearSearch.classList.toggle('visible', searchInput.value.length > 0);
                    searchLoading.classList.remove('active');
                }, 100);
            }, 200);

            searchInput.addEventListener('input', debouncedSearch);

            searchType.addEventListener('change', () => {
                filterFunds();
                updateSuggestions();
            });

            searchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    suggestions.classList.remove('active');
                    filterFunds();
                } else if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {
                    e.preventDefault();
                    const items = suggestions.querySelectorAll('.suggestion-item');
                    if (items.length === 0) return;
                    const current = document.activeElement.classList.contains('suggestion-item') ? document.activeElement : null;
                    let index = current ? Array.from(items).indexOf(current) : -1;
                    if (e.key === 'ArrowDown') {
                        index = Math.min(index + 1, items.length - 1);
                    } else if (e.key === 'ArrowUp') {
                        index = Math.max(index - 1, 0);
                    }
                    items[index].focus();
                }
            });

            clearSearch.addEventListener('click', () => {
                searchInput.value = '';
                clearSearch.classList.remove('visible');
                suggestions.classList.remove('active');
                filterFunds();
            });

            suggestions.addEventListener('click', (e) => {
                const item = e.target.closest('.suggestion-item');
                if (item) {
                    searchInput.value = item.dataset.value;
                    saveSearch(item.dataset.value);
                    suggestions.classList.remove('active');
                    filterFunds();
                    searchInput.focus();
                }
            });

            document.addEventListener('click', (e) => {
                if (!searchInput.contains(e.target) && !suggestions.contains(e.target) && !searchType.contains(e.target)) {
                    suggestions.classList.remove('active');
                }
            });

            document.querySelectorAll('.filter-btn').forEach(btn => btn.addEventListener('click', function() {
                const filterGroup = this.closest('.filter-group');
                if (this.dataset.filter === 'all') {
                    filterGroup.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                } else {
                    filterGroup.querySelector('[data-filter="all"]').classList.remove('active');
                    this.classList.toggle('active');
                    const hasActive = filterGroup.querySelector('.filter-btn:not([data-filter="all"]).active');
                    if (!hasActive) {
                        filterGroup.querySelector('[data-filter="all"]').classList.add('active');
                    }
                }
                filterFunds();
            }));
            document.getElementById('sortDropdown').addEventListener('change', filterFunds);
            document.getElementById('fundingModal').addEventListener('click', e => { if (e.target === e.currentTarget) closeModal(); });
            document.addEventListener('keydown', e => {
                if (e.key === 'Escape') {
                    if (suggestions.classList.contains('active')) {
                        suggestions.classList.remove('active');
                    } else if (document.getElementById('fundingModal').classList.contains('active')) {
                        closeModal();
                    }
                }
            });
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function saveSearch(term) {
            let searches = JSON.parse(localStorage.getItem('recentSearches') || '[]');
            searches = [term, ...searches.filter(s => s !== term)].slice(0, 5);
            localStorage.setItem('recentSearches', JSON.stringify(searches));
        }

        function getRecentSearches() {
            return JSON.parse(localStorage.getItem('recentSearches') || '[]');
        }

        function updateSuggestions() {
            const searchInput = document.getElementById('searchInput');
            const searchType = document.getElementById('searchType').value;
            const suggestions = document.getElementById('suggestions');
            const searchTerm = searchInput.value.toLowerCase().trim();
            suggestions.innerHTML = '';

            if (searchTerm.length < 2) {
                const recentSearches = getRecentSearches();
                if (recentSearches.length > 0) {
                    suggestions.innerHTML = '<div class="search-history-title">Búsquedas recientes</div>';
                    recentSearches.forEach(term => {
                        const div = document.createElement('div');
                        div.className = 'suggestion-item';
                        div.dataset.value = term;
                        div.tabIndex = 0;
                        div.setAttribute('role', 'option');
                        div.innerHTML = `<span>${highlightText(term, searchTerm)}</span><span class="suggestion-type">Reciente</span>`;
                        suggestions.appendChild(div);
                    });
                    suggestions.classList.add('active');
                } else {
                    suggestions.classList.remove('active');
                }
                return;
            }

            const fuseOptions = {
                includeScore: true,
                threshold: 0.3,
                keys: searchType === 'all' ? ['name', 'description', 'institution', 'focus', 'requirements'] : [searchType]
            };
            const fuse = new Fuse(fundingData, fuseOptions);
            const results = fuse.search(searchTerm).slice(0, 5);

            if (results.length === 0) {
                suggestions.innerHTML = '<div class="suggestion-item text-gray-400">No hay sugerencias</div>';
            } else {
                results.forEach(result => {
                    const fund = result.item;
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.dataset.value = fund.name;
                    div.tabIndex = 0;
                    div.setAttribute('role', 'option');
                    const displayText = searchType === 'all' || searchType === 'name' ? fund.name : 
                        searchType === 'institution' ? fund.institution : 
                        searchType === 'focus' ? fund.focus.join(', ') : fund.requirements.join(', ');
                    div.innerHTML = `<span>${highlightText(displayText, searchTerm)}</span><span class="suggestion-type">${searchType === 'all' ? 'Fondo' : searchType.charAt(0).toUpperCase() + searchType.slice(1)}</span>`;
                    suggestions.appendChild(div);
                });
            }

            const recentSearches = getRecentSearches().filter(term => term.toLowerCase().includes(searchTerm)).slice(0, 3);
            if (recentSearches.length > 0) {
                suggestions.innerHTML += '<div class="search-history-title">Búsquedas recientes</div>';
                recentSearches.forEach(term => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.dataset.value = term;
                    div.tabIndex = 0;
                    div.setAttribute('role', 'option');
                    div.innerHTML = `<span>${highlightText(term, searchTerm)}</span><span class="suggestion-type">Reciente</span>`;
                    suggestions.appendChild(div);
                });
            }

            suggestions.classList.add('active');
        }

        function highlightText(text, searchTerm) {
            if (!searchTerm) return text;
            const terms = searchTerm.split(/\s+/).filter(t => t.length > 0);
            let highlighted = text;
            terms.forEach(term => {
                const regex = new RegExp(`(${term})`, 'gi');
                highlighted = highlighted.replace(regex, '<span class="highlight">$1</span>');
            });
            return highlighted;
        }

        function filterFunds() {
            const activeTabFilter = document.querySelector('#tab-navigation .tab-link.active').dataset.tabFilter;
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            const searchType = document.getElementById('searchType').value;
            const activeTypeFilters = getActiveFilters('typeFilters');
            const activeFocusFilters = getActiveFilters('focusFilters');

            let filtered = fundingData;
            if (searchTerm) {
                const fuseOptions = {
                    includeScore: true,
                    threshold: 0.3,
                    keys: searchType === 'all' ? ['name', 'description', 'institution', 'focus', 'requirements'] : [searchType]
                };
                const fuse = new Fuse(fundingData, fuseOptions);
                filtered = fuse.search(searchTerm).map(result => result.item);
            }

            filtered = filtered.filter(fund => {
                const matchesTab = activeTabFilter === 'all' || fund.type === activeTabFilter || 
                    (activeTabFilter === 'educacion' && fund.focus.includes('educacion')) || 
                    (activeTabFilter === 'medioambiente' && fund.focus.includes('medioambiente'));
                const matchesType = activeTypeFilters.length === 0 || activeTypeFilters.includes(fund.type);
                const matchesFocus = activeFocusFilters.length === 0 || fund.focus.some(f => activeFocusFilters.includes(f));
                return matchesTab && matchesType && matchesFocus;
            });

            const sortOption = document.getElementById('sortDropdown').value;
            filtered.sort((a, b) => {
                if (sortOption === 'name') return a.name.localeCompare(b.name);
                if (sortOption === 'amount') return b.amount - a.amount;
                if (sortOption === 'type') return a.type.localeCompare(b.type);
                if (sortOption === 'cofinance') return a.cofinancing - b.cofinancing;
                return 0;
            });

            renderFundingCards(filtered, searchTerm);
            updateResultsInfo(filtered);
            updateFilterCounts();
        }

        function getActiveFilters(filterGroupId) {
            const activeFilters = [];
            document.querySelectorAll(`#${filterGroupId} .filter-btn.active:not([data-filter="all"])`).forEach(btn => {
                activeFilters.push(btn.dataset.filter);
            });
            return activeFilters;
        }

        function updateStats() {
            const totalFunds = fundingData.length;
            const publicFunds = fundingData.filter(fund => fund.type === 'publico').length;
            const privateFunds = fundingData.filter(fund => fund.type === 'privado').length;
            const maxAmount = fundingData.length ? Math.max(...fundingData.map(fund => fund.amount)) : 0;

            document.getElementById('totalFunds').textContent = totalFunds;
            document.getElementById('publicFunds').textContent = publicFunds;
            document.getElementById('privateFunds').textContent = privateFunds;
            document.getElementById('maxAmount').textContent = formatAmount(maxAmount);
        }

        function formatAmount(amount) {
            if (amount >= 1000000000) return `$${(amount / 1000000000).toFixed(1)}B`;
            if (amount >= 1000000) return `$${(amount / 1000000).toFixed(1)}M`;
            return `$${amount.toLocaleString('es-CL')}`;
        }

        function renderFundingCards(funds, searchTerm) {
            const fundingGrid = document.getElementById('fundingGrid');
            fundingGrid.innerHTML = '';
            if (funds.length === 0) {
                document.getElementById('noResults').style.display = 'block';
                return;
            }
            document.getElementById('noResults').style.display = 'none';

            funds.forEach(fund => {
                const card = document.createElement('div');
                card.className = 'funding-card bg-gray-900/70 p-6 rounded-xl transition-transform duration-300 border border-white/10 cursor-pointer';
                card.tabIndex = 0;
                card.setAttribute('aria-label', `Ver detalles de ${fund.name}`);
                card.innerHTML = `
                    <h3 class="text-xl font-semibold text-white mb-2">${highlightText(fund.name, searchTerm)}</h3>
                    <p class="text-gray-400 mb-4 line-clamp-3">${highlightText(fund.description, searchTerm)}</p>
                    <div class="flex justify-between items-center text-sm">
                        <span class="text-[var(--primary)] font-medium">${fund.amountText}</span>
                        <span class="text-gray-500">${highlightText(fund.institution, searchTerm)}</span>
                    </div>
                    <div class="mt-4 flex flex-wrap gap-2">
                        ${fund.focus.map(f => `<span class="inline-block bg-[var(--primary)]/20 text-[var(--primary)] text-xs px-2 py-1 rounded-full">${highlightText(f, searchTerm)}</span>`).join('')}
                    </div>
                `;
                card.addEventListener('click', () => openModal(fund));
                card.addEventListener('keypress', e => {
                    if (e.key === 'Enter') openModal(fund);
                });
                fundingGrid.appendChild(card);
            });
        }

        function openModal(fund) {
            const modal = document.getElementById('fundingModal');
            const modalContent = modal.querySelector('.modal-content');
            modalContent.innerHTML = `
                <button class="absolute top-4 right-4 text-gray-400 hover:text-white focus:outline-none" onclick="closeModal()" aria-label="Cerrar modal">
                    <i class="fas fa-times text-xl"></i>
                </button>
                <h2 id="modalTitle" class="text-2xl font-bold text-white mb-4">${fund.name}</h2>
                <p class="text-gray-300 mb-4">${fund.description}</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <p class="text-gray-400"><strong>Institución:</strong> ${fund.institution}</p>
                        <p class="text-gray-400"><strong>Tipo:</strong> ${fund.category}</p>
                        <p class="text-gray-400"><strong>Monto:</strong> ${fund.amountText}</p>
                        <p class="text-gray-400"><strong>Cofinanciamiento:</strong> ${fund.cofinancing}%</p>
                    </div>
                    <div>
                        <p class="text-gray-400"><strong>Duración:</strong> ${fund.duration}</p>
                        <p class="text-gray-400"><strong>Fecha límite:</strong> ${fund.deadline}</p>
                        <p class="text-gray-400"><strong>Enfoque:</strong> ${fund.focus.join(', ')}</p>
                        <p class="text-gray-400"><strong>Requisitos:</strong> ${fund.requirements.join(', ')}</p>
                    </div>
                </div>
                <a href="${fund.link}" target="_blank" class="inline-block mt-6 bg-[var(--primary)] text-white py-2 px-4 rounded-lg hover:bg-[var(--primary-dark)] transition-colors focus:outline-none">
                    <i class="fas fa-link mr-2"></i> Más Información
                </a>
            `;
            modal.classList.add('active');
            modal.setAttribute('aria-hidden', 'false');
            modalContent.focus();
        }

        function closeModal() {
            const modal = document.getElementById('fundingModal');
            modal.classList.remove('active');
            modal.setAttribute('aria-hidden', 'true');
            document.querySelector('#tab-navigation .tab-link.active').focus();
        }

        function updateResultsInfo(filteredFunds) {
            document.getElementById('resultsCount').textContent = filteredFunds.length;
            document.getElementById('totalCount').textContent = fundingData.length;
        }

        function updateFilterCounts() {
            const activeTabFilter = document.querySelector('#tab-navigation .tab-link.active').dataset.tabFilter;
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const searchType = document.getElementById('searchType').value;

            let filtered = fundingData;
            if (searchTerm) {
                const fuseOptions = {
                    includeScore: true,
                    threshold: 0.3,
                    keys: searchType === 'all' ? ['name', 'description', 'institution', 'focus', 'requirements'] : [searchType]
                };
                const fuse = new Fuse(fundingData, fuseOptions);
                filtered = fuse.search(searchTerm).map(result => result.item);
            }

            document.querySelectorAll('#typeFilters .filter-btn').forEach(btn => {
                const filter = btn.dataset.filter;
                const count = filter === 'all' ? filtered.length : filtered.filter(fund => 
                    fund.type === filter && 
                    (activeTabFilter === 'all' || fund.type === activeTabFilter || 
                    (activeTabFilter === 'educacion' && fund.focus.includes('educacion')) || 
                    (activeTabFilter === 'medioambiente' && fund.focus.includes('medioambiente')))
                ).length;
                btn.querySelector('.filter-count').textContent = count;
            });

            document.querySelectorAll('#focusFilters .filter-btn').forEach(btn => {
                const filter = btn.dataset.filter;
                const count = filter === 'all' ? filtered.length : filtered.filter(fund => 
                    fund.focus.includes(filter) && 
                    (activeTabFilter === 'all' || fund.type === activeTabFilter || 
                    (activeTabFilter === 'educacion' && fund.focus.includes('educacion')) || 
                    (activeTabFilter === 'medioambiente' && fund.focus.includes('medioambiente')))
                ).length;
                btn.querySelector('.filter-count').textContent = count;
            });
        }

        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('searchType').value = 'all';
            document.getElementById('clearSearch').classList.remove('visible');
            document.getElementById('suggestions').classList.remove('active');
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector('#typeFilters .filter-btn[data-filter="all"]').classList.add('active');
            document.querySelector('#focusFilters .filter-btn[data-filter="all"]').classList.add('active');
            document.querySelector('#tab-navigation .tab-link[data-tab-filter="all"]').click();
            filterFunds();
        }
    </script>
</body>
</html>
