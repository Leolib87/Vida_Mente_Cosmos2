<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explorador de Software de Bioinformática | O.C.V.M.</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #818cf8;
            --primary-dark: #6366f1;
            --secondary: #22d3ee;
            --primary-text: #e5e7eb;
            --primary-glow: #818cf8;
            --secondary-glow: #22d3ee;
            --font-main: 'Inter', sans-serif;
            --nav-height: 70px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        html { scroll-behavior: smooth; }

        body {
            background-color: #000000;
            color: var(--primary-text);
            font-family: var(--font-main);
            line-height: 1.8;
            overflow-x: hidden;
        }
        
        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            cursor: crosshair;
        }

        .glassmorphism {
            background: rgba(17, 24, 39, 0.8);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        body.menu-open {
            overflow: hidden;
        }
        
        nav {
            position: fixed; top: 0; width: 100%; height: var(--nav-height);
            z-index: 1000;
            display: flex; justify-content: center; align-items: center;
            padding: 0 5%;
            pointer-events: auto;
        }

        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }
        
        .nav-logo a {
            font-size: 1.3em;
            font-weight: 700;
            color: #fff;
            text-decoration: none;
            text-shadow: 0 0 8px var(--primary-glow);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .nav-container { display: flex; justify-content: center; align-items: center; list-style: none; height: 100%; gap: 0.5rem;}
        nav .nav-container > li { position: relative; height: 100%; display: flex; align-items: center; }
        nav .nav-container > li > a {
            color: var(--primary-text); text-decoration: none; font-size: clamp(0.9em, 1.2vw, 1.05em); font-weight: 500;
            transition: color 0.3s ease, text-shadow 0.3s ease; padding: 0 1rem; display: flex; align-items: center; gap: 8px;
        }
        nav .nav-container > li > a:hover, nav .nav-container > li:hover > a { color: #FFFFFF; text-shadow: 0 0 12px var(--primary-glow); }
        
        .nav-icon { width: 20px; height: 20px; stroke-width: 1.5; }
        
        .mega-menu {
            position: fixed;
            top: var(--nav-height);
            left: 50%;
            transform: translateX(-50%) scale(0.95);
            border-radius: 10px; width: auto;
            min-width: clamp(300px, 80vw, 950px); max-width: 95vw;
            padding: 2rem; 
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 2rem; 
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, transform 0.3s ease, visibility 0s 0.3s;
            transform-origin: top center;
        }
        
        .mega-menu.is-active { 
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) scale(1);
            transition: opacity 0.3s ease, transform 0.3s ease, visibility 0s 0s;
        }
        
        .mega-menu h3 {
            color: var(--primary-glow); font-size: 1.1em; margin-bottom: 1rem;
            text-shadow: 0 0 5px var(--primary-glow);
            border-bottom: 1px solid rgba(129, 140, 248, 0.3);
            padding-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        .mega-menu ul { display: flex; flex-direction: column; gap: 0.75rem; list-style: none; }
        .mega-menu li { position: relative; }
        .mega-menu a {
            font-size: 0.9em; color: var(--primary-text); text-decoration: none;
            transition: color 0.3s, padding-left 0.3s, background-color 0.3s;
            padding: 0.5rem 0.75rem 0.5rem 2rem; border-radius: 4px;
            display: block;
            position: relative;
        }
        .mega-menu a::before {
            content: '›';
            color: var(--primary-glow);
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2em;
            transition: color 0.3s;
        }
        .mega-menu a:hover { color: #000; background-color: var(--primary-glow); padding-left: 2.5rem; }
        .mega-menu a:hover::before { color: #000; }
        
        .hero {
            min-height: 60vh;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            text-align: center; position: relative;
            padding: 1rem clamp(1rem, 5vw, 4rem);
        }
        .hero-content { position: relative; z-index: 2; animation: fadeIn 2s ease-in; }
        .hero h1 {
            font-size: clamp(2.5rem, 8vw, 5.5rem); font-weight: 700; color: #fff;
            text-shadow: 0 0 10px var(--primary-glow), 0 0 20px var(--primary-glow), 0 0 40px rgba(129, 140, 248, 0.7);
            animation: pulse-glow 3s infinite alternate;
        }
        .hero p { font-size: clamp(1rem, 2.5vw, 1.3rem); max-width: 800px; margin: 1.5rem auto 0; text-shadow: 0 0 5px #000; }
        @keyframes pulse-glow {
            from { text-shadow: 0 0 10px var(--primary-glow), 0 0 20px var(--primary-glow); }
            to { text-shadow: 0 0 20px var(--primary-glow), 0 0 40px var(--primary-glow); }
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .main-container { 
            width: 100%;
            margin: 0 auto; 
            padding: var(--nav-height) 0 1rem;
            pointer-events: none;
        }
        
        main, .footer, .section, .hero-content {
            pointer-events: auto;
        }

        main p, .footer p {
            user-select: text;
            cursor: default;
        }

        .layout-grid { display: grid; grid-template-columns: 1fr; gap: 2rem; margin-top: 2rem; }
        
        .section {
            padding: clamp(1.5rem, 5vw, 2.5rem);
            border-radius: 12px; margin-bottom: 2rem; position: relative;
            transition: transform 0.4s ease, box-shadow 0.4s ease;
        }
        .section:hover { transform: translateY(-5px); box-shadow: 0 0 40px rgba(129, 140, 248, 0.2); }
        
        .section h2, .section h3, .section p, .section .visualization-container, .section iframe, .section .content-section, .section .tabs-nav {
             opacity: 0;
             transform: translateY(20px);
             transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }

        .section.is-visible h2, .section.is-visible h3, .section.is-visible p, .section.is-visible .visualization-container, .section.is-visible iframe, .section.is-visible .content-section, .section.is-visible .tabs-nav {
            opacity: 1;
            transform: translateY(0);
        }
        
        h2 {
            font-size: clamp(1.5rem, 5vw, 2.2rem); color: var(--primary-text); text-shadow: 0 0 8px var(--secondary-glow);
            border-bottom: 1px solid var(--primary-glow); padding-bottom: 1rem; margin-bottom: 1.5rem;
        }
        h3 { font-size: clamp(1.2rem, 4vw, 1.5rem); color: var(--primary-glow); margin: 2rem 0 1rem 0; }
        .highlight { color: var(--primary-glow); font-weight: bold; }
        
        .footer { text-align: center; padding: 2.5rem clamp(1rem, 5vw, 4rem); color: var(--primary-glow); border-top: 1px solid var(--primary-text); margin-top: 2rem; }
        
        @media (min-width: 1025px) {
            .menu-toggle { display: none; }
            .nav-container { display: flex; }
        }

        @media (max-width: 1024px) {
            .nav-content { justify-content: space-between; }
            .nav-container {
                position: fixed;
                top: var(--nav-height);
                left: 0;
                width: 100%;
                height: calc(100vh - var(--nav-height));
                background: rgba(17, 24, 39, 0.95);
                backdrop-filter: blur(15px);
                flex-direction: column;
                justify-content: flex-start;
                align-items: center;
                transition: transform 0.4s cubic-bezier(0.23, 1, 0.32, 1);
                transform: translateY(-110%);
                overflow-y: auto;
                padding: 2rem;
            }
            body.menu-open .nav-container {
                transform: translateY(0);
            }

            nav .nav-container > li { width: 100%; height: auto; flex-direction: column; align-items: center; text-align: center; }
            nav .nav-container > li > a { padding: 1rem; width: 100%; font-size: 1.5em;}
            
            .mega-menu {
                position: static; display: grid; opacity: 1; transform: none; visibility: visible; width: 100%; box-shadow: none; 
                border: none; padding: 1rem 0 1.5rem 0; background: none; backdrop-filter: none;
                grid-template-columns: 1fr; border-top: 1px solid rgba(129, 140, 248, 0.2); margin-top: 1rem;
            }
            
            .mega-menu h3 { 
                text-align: center; 
                font-size: 1.8em;
            }
            .mega-menu ul { 
                align-items: stretch;
                text-align: left;
                list-style: none;
                padding-left: 0;
            }
            
            .mega-menu a {
                font-size: 1.5em;
                padding: 0.8rem 1rem 0.8rem 2.5rem;
                display: block;
                text-align: left;
                position: relative;
            }

            .mega-menu a::before {
                content: '■';
                color: var(--primary-glow);
                position: absolute;
                left: 0.5rem;
                top: 50%;
                transform: translateY(-50%) scale(0.6);
                font-size: 1.5em;
            }

            .mega-menu a:hover {
                padding-left: 2.5rem;
                color: #000;
                background-color: var(--primary-glow);
            }
            .mega-menu a:hover::before {
                color: #000;
            }
            
            .menu-toggle {
                display: block; position: relative; z-index: 1001;
                width: 30px; height: 22px;
                background: none; border: none; cursor: pointer;
            }
            .icon-bar {
                display: block; width: 100%; height: 3px; background-color: var(--primary-text); 
                margin: 6px 0; transition: all 0.3s ease-in-out;
                border-radius: 2px;
            }

            body.menu-open .menu-toggle .icon-bar:nth-child(1) { transform: rotate(45deg) translate(7px, 7px); }
            body.menu-open .menu-toggle .icon-bar:nth-child(2) { opacity: 0; }
            body.menu-open .menu-toggle .icon-bar:nth-child(3) { transform: rotate(-45deg) translate(7px, -7px); }
        }
        
        /* --- STYLES FOR BIOINFORMATICS EXPLORER --- */
        .tabs-nav {
            overflow-x: auto;
            white-space: nowrap;
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        .tabs-nav::-webkit-scrollbar {
            display: none; /* Chrome, Safari, and Opera */
        }

        .tabs-nav-link {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
            color: var(--primary-text);
            flex-shrink: 0; /* Prevent tabs from shrinking */
        }
        .tabs-nav-link.active {
            border-bottom-color: var(--primary-glow);
            color: #FFFFFF;
            font-weight: 600;
            text-shadow: 0 0 8px var(--primary-glow);
        }
        .tabs-nav-link:hover {
            border-bottom-color: var(--secondary-glow);
            color: #FFFFFF;
        }

        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .table-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        table {
            width: 100%;
            min-width: 800px;
        }
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 150px;
            height: 34px;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #334155;
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 70px;
            left: 4px;
            bottom: 4px;
            background-color: #475569;
            transition: .4s;
            border-radius: 22px;
        }
        input:checked + .slider {
            background-color: var(--primary);
        }
        input:checked + .slider:before {
            transform: translateX(70px);
        }
        .slider-text {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: space-around;
            color: white;
            font-weight: 500;
            font-size: 12px;
            pointer-events: none;
            padding-left: 5px;
            padding-right: 5px;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
    </style>
</head>
<body>
    <canvas id="bg-canvas" aria-hidden="true"></canvas>
    <nav class="glassmorphism">
        <div class="nav-content">
            <div class="nav-logo">
                <a href="index.html">
                    <img src="https://placehold.co/40x40/818cf8/000000?text=O" alt="Logo O.C.V.M." class="h-8 w-8 md:h-10 md:w-10 rounded-full">
                    <span>O.C.V.M.</span>
                </a>
            </div>
            <ul class="nav-container" id="nav-menu">
                <li><a href="index.html">
                    <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" /></svg>
                    Inicio</a></li>
    
                <li><a href="#inicio">
                    <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 4.5v15m6-15v15m-10.875 0h15.75c.621 0 1.125-.504 1.125-1.125V5.625c0-.621-.504-1.125-1.125-1.125H4.125C3.504 4.5 3 5.004 3 5.625v12.75c0 .621.504 1.125 1.125 1.125z" /></svg>
                    Bioinformática</a>
                </li>
                
                <li><a href="#contacto">
                    <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" /></svg>
                    Contacto</a></li>
            </ul>
            <button class="menu-toggle" id="menu-toggle-btn" aria-label="Abrir o cerrar menú">
                <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
            </button>
        </div>
    </nav>

    <div class="main-container" id="inicio">
        <div class="hero">
            <div class="hero-content">
                <h1>Explorador de Software de Bioinformática</h1>
                <p>Una guía interactiva para herramientas de análisis genómico, proteómico y de clonación.</p>
            </div>
        </div>

        <div class="layout-grid">
            <main class="content">
                <section id="bioinfo-content" class="glassmorphism" data-animate>
                    
                    <nav class="tabs-nav flex justify-start md:justify-center items-center border-b-2" style="border-color: rgba(129, 140, 248, 0.3);">
                        <a href="#genomico" class="tabs-nav-link p-3 sm:p-4 text-sm sm:text-lg active">Análisis Genómico</a>
                        <a href="#proteinas" class="tabs-nav-link p-3 sm:p-4 text-sm sm:text-lg">Análisis de Proteínas</a>
                        <a href="#clonacion" class="tabs-nav-link p-3 sm:p-4 text-sm sm:text-lg">Clonación Molecular</a>
                        <a href="#movil" class="tabs-nav-link p-3 sm:p-4 text-sm sm:text-lg">Herramientas Móviles</a>
                        <a href="#dashboard" class="tabs-nav-link p-3 sm:p-4 text-sm sm:text-lg">Dashboard</a>
                    </nav>

                    <div class="mt-12 md:mt-16">
                        <div id="genomico" class="content-section active px-6">
                            <h2 style="border-bottom: none; padding-bottom: 0.5rem; margin-bottom: 1rem; font-size: clamp(1.5rem, 5vw, 2rem);">Software para Análisis Genómico y Transcriptómico</h2>
                            <p class="mb-8">Esta sección explora el diverso panorama de herramientas diseñadas para el análisis de secuencias de nucleótidos. Abarca desde el análisis de trazas de secuenciación Sanger individuales hasta el procesamiento a escala poblacional de datos de secuenciación del genoma completo (WGS) y ARN-Seq, reflejando la amplitud de la investigación genómica moderna. Use el selector para filtrar entre herramientas gratuitas y comerciales.</p>
                            <div id="table-genomico-container"></div>
                        </div>

                        <div id="proteinas" class="content-section px-6">
                            <h2 style="border-bottom: none; padding-bottom: 0.5rem; margin-bottom: 1rem; font-size: clamp(1.5rem, 5vw, 2rem);">Software para Análisis de Secuencias y Estructuras de Proteínas</h2>
                            <p class="mb-8">Esta sección se adentra en el dominio de la proteómica y la biología estructural, cubriendo los recursos esenciales que van desde las bases de datos fundacionales hasta las herramientas de predicción de estructuras impulsadas por inteligencia artificial que están revolucionando el campo. Use el selector para filtrar entre herramientas gratuitas y comerciales.</p>
                            <div id="table-proteinas-container"></div>
                        </div>

                        <div id="clonacion" class="content-section px-6">
                            <h2 style="border-bottom: none; padding-bottom: 0.5rem; margin-bottom: 1rem; font-size: clamp(1.5rem, 5vw, 2rem);">Software para Clonación Molecular y Biología Sintética</h2>
                            <p class="mb-8">El diseño *in silico* de construcciones de ADN se ha convertido en un paso estándar y esencial en la biología molecular moderna. El software en esta categoría permite a los investigadores planificar, simular y documentar experimentos de clonación con precisión. Use el selector para filtrar entre herramientas gratuitas y comerciales.</p>
                            <div id="table-clonacion-container"></div>
                        </div>

                        <div id="movil" class="content-section px-6">
                            <h2 style="border-bottom: none; padding-bottom: 0.5rem; margin-bottom: 1rem; font-size: clamp(1.5rem, 5vw, 2rem);">Bioinformática en Tabletas y Teléfonos Inteligentes</h2>
                            <p class="mb-8">La ubicuidad de los dispositivos móviles ha abierto una nueva frontera para el software bioinformático. Si bien estas plataformas no pueden reemplazar el poder computacional de los ordenadores de sobremesa, ofrecen una conveniencia única para tareas específicas de visualización y acceso rápido a los datos. La mayoría son gratuitas.</p>
                            <div id="table-movil-container"></div>
                        </div>

                        <div id="dashboard" class="content-section px-6">
                            <h2 style="border-bottom: none; padding-bottom: 0.5rem; margin-bottom: 1rem; font-size: clamp(1.5rem, 5vw, 2rem);">Dashboard del Ecosistema de Software</h2>
                            <p class="mb-8">Esta vista general proporciona una instantánea visual del panorama del software bioinformático cubierto en este explorador. El gráfico de la izquierda muestra la distribución de herramientas entre plataformas de escritorio, soluciones basadas en la nube y aplicaciones móviles. El gráfico de la derecha ilustra la proporción de herramientas comerciales (de pago) frente a las gratuitas (incluido el código abierto), destacando la diversidad de modelos de licencia disponibles para los investigadores.</p>
                            <div class="grid md:grid-cols-2 gap-8">
                                <div class="p-6 rounded-xl">
                                    <h3 class="text-xl font-semibold text-center mb-4">Distribución por Plataforma</h3>
                                    <div class="chart-container">
                                        <canvas id="platformChart"></canvas>
                                    </div>
                                </div>
                                <div class="p-6 rounded-xl">
                                    <h3 class="text-xl font-semibold text-center mb-4">Distribución por Tipo de Licencia</h3>
                                    <div class="chart-container">
                                         <canvas id="licenseChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </section>
            </main>
        </div>
        <footer class="footer" id="contacto">
            <h2>Contacto</h2>
            <p>Este espacio es una cartografía personal y una invitación al diálogo.</p>
            <p style="margin-top:1.5rem; font-size: 0.9em;">La vida es terriblemente bella cuando los jugadores juegan. | 2025</p>
        </footer>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Three.js Background
            if (typeof THREE !== 'undefined') {
                initThreeJS();
            } else {
                console.error("Three.js not loaded");
            }

            // Setup Navigation and other event listeners
            setupNavigation();
            setupScrollAnimations();
            
            // --- BIOINFORMATICS EXPLORER LOGIC ---
            setupBioinfoExplorer();
        });

        // --- THREE.JS BACKGROUND ---
        let scene, camera, renderer, points, lines;
        
        function initThreeJS() {
            try {
                scene = new THREE.Scene();
                camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 1000);
                camera.position.z = 50;

                renderer = new THREE.WebGLRenderer({
                    canvas: document.getElementById("bg-canvas"),
                    alpha: true
                });
                renderer.setSize(window.innerWidth, window.innerHeight);

                const pointCount = 200;
                const positions = new Float32Array(pointCount * 3);
                const pointGeo = new THREE.BufferGeometry();
                for (let i = 0; i < pointCount; i++) {
                    positions[i * 3] = (Math.random() - 0.5) * 400;
                    positions[i * 3 + 1] = (Math.random() - 0.5) * 400;
                    positions[i * 3 + 2] = (Math.random() - 0.5) * 400;
                }
                pointGeo.setAttribute('position', new THREE.BufferAttribute(positions, 3));

                const pointMaterial = new THREE.PointsMaterial({ color: 0x818cf8, size: 1.5, transparent: true, opacity: 0.8 });
                points = new THREE.Points(pointGeo, pointMaterial);
                scene.add(points);

                regenerateLines();

                window.addEventListener("resize", onWindowResize, false);
                document.addEventListener('mousemove', onMouseMove, false);
                renderer.domElement.addEventListener('click', onCanvasClick, false);
                animate();
            } catch (error) {
                console.error('Error initializing Three.js:', error);
            }
        }

        function onWindowResize() {
            if(camera && renderer) {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            }
        }

        let mouseX = 0, mouseY = 0;
        function onMouseMove(event) {
            mouseX = (event.clientX - window.innerWidth / 2) / 100;
            mouseY = (event.clientY - window.innerHeight / 2) / 100;
        }

        function animate() {
            requestAnimationFrame(animate);
            if(scene && camera && renderer && points && lines) {
                points.rotation.y += 0.0005;
                lines.rotation.y += 0.0005;
                camera.position.x += (mouseX - camera.position.x) * 0.05;
                camera.position.y += (-mouseY - camera.position.y) * 0.05;
                camera.lookAt(scene.position);
                renderer.render(scene, camera);
            }
        }

        function onCanvasClick(event) {
            const mouse = new THREE.Vector2();
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

            const vector = new THREE.Vector3(mouse.x, mouse.y, 0.5);
            vector.unproject(camera);
            const dir = vector.sub(camera.position).normalize();
            const distance = -camera.position.z / dir.z;
            const pos = camera.position.clone().add(dir.multiplyScalar(distance));
            addPoint(pos);
        }

        function addPoint(position) {
            const oldPositions = points.geometry.attributes.position.array;
            const newPointCount = oldPositions.length / 3 + 1;
            const newPositions = new Float32Array(newPointCount * 3);
            newPositions.set(oldPositions);
            newPositions[oldPositions.length] = position.x;
            newPositions[oldPositions.length + 1] = position.y;
            newPositions[oldPositions.length + 2] = position.z;
            points.geometry.setAttribute('position', new THREE.BufferAttribute(newPositions, 3));
            points.geometry.attributes.position.needsUpdate = true;
            regenerateLines();
        }

        function regenerateLines() {
            if (lines) scene.remove(lines);
            const pointPositions = points.geometry.attributes.position.array;
            const pointCount = pointPositions.length / 3;
            const linePositions = [];
            for (let i = 0; i < pointCount; i++) {
                for (let j = i + 1; j < pointCount; j++) {
                    const dx = pointPositions[i * 3] - pointPositions[j * 3];
                    const dy = pointPositions[i * 3 + 1] - pointPositions[j * 3 + 1];
                    const dz = pointPositions[i * 3 + 2] - pointPositions[j * 3 + 2];
                    const dist = Math.sqrt(dx * dx + dy * dy + dz * dz);
                    if (dist < 50) {
                        linePositions.push(pointPositions[i * 3], pointPositions[i * 3 + 1], pointPositions[i * 3 + 2]);
                        linePositions.push(pointPositions[j * 3], pointPositions[j * 3 + 1], pointPositions[j * 3 + 2]);
                    }
                }
            }
            const lineGeo = new THREE.BufferGeometry();
            lineGeo.setAttribute('position', new THREE.Float32BufferAttribute(linePositions, 3));
            const lineMaterial = new THREE.LineBasicMaterial({ color: 0x22d3ee, opacity: 0.3, transparent: true });
            lines = new THREE.LineSegments(lineGeo, lineMaterial);
            scene.add(lines);
        }

        // --- NAVIGATION SCRIPTS ---
        function setupNavigation() {
            const menuToggleBtn = document.getElementById('menu-toggle-btn');
            const navMenu = document.getElementById('nav-menu');

            menuToggleBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                document.body.classList.toggle('menu-open');
            });

            navMenu.addEventListener('click', (e) => {
                if (e.target.tagName === 'A' && window.innerWidth <= 1024) {
                   document.body.classList.remove('menu-open');
                }
            });

            if (window.matchMedia('(min-width: 1025px)').matches) {
                const menuItems = document.querySelectorAll('.nav-container > li');
                menuItems.forEach(item => {
                    const megaMenu = item.querySelector('.mega-menu');
                    if (megaMenu) {
                        let leaveTimeout;
                        const showMenu = () => {
                            clearTimeout(leaveTimeout);
                            document.querySelectorAll('.mega-menu.is-active').forEach(m => {
                                if (m !== megaMenu) m.classList.remove('is-active');
                            });
                            megaMenu.classList.add('is-active');
                        };
                        const startHideTimer = () => {
                            leaveTimeout = setTimeout(() => megaMenu.classList.remove('is-active'), 250);
                        };
                        item.addEventListener('mouseenter', showMenu);
                        item.addEventListener('mouseleave', startHideTimer);
                    }
                });
            }
        }

        // --- SCROLL ANIMATION ---
        function setupScrollAnimations() {
            const animatedSections = document.querySelectorAll('[data-animate]');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        
                        const elementsToAnimate = entry.target.querySelectorAll('h2, h3, p, .visualization-container, iframe, .content-section, .tabs-nav');
                        elementsToAnimate.forEach((el, index) => {
                           el.style.transitionDelay = `${index * 150}ms`;
                        });

                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });
            animatedSections.forEach(section => observer.observe(section));
        }

        // --- BIOINFORMATICS EXPLORER LOGIC ---
        function setupBioinfoExplorer() {
            const softwareData = {
                genomico: {
                    free: [
                        { name: 'UGENE', description: 'Suite de bioinformática de escritorio, integrada y multiplataforma. Alternativa de código abierto a Geneious.', features: 'Visualización y edición de secuencias, alineamiento, diseño de primers, filogenia, análisis NGS.', link: 'http://ugene.net/', license: 'Gratuito, Código Abierto (GPLv2)' },
                        { name: 'Galaxy', description: 'Plataforma web de código abierto para análisis reproducibles y accesibles.', features: 'Integración de cientos de herramientas, construcción de flujos de trabajo, gestión de historiales.', link: 'https://usegalaxy.org/', license: 'Gratuito, Código Abierto' },
                        { name: 'R / Bioconductor', description: 'Entorno de programación para computación estadística y análisis de datos ómicos.', features: 'Análisis de expresión diferencial (ARN-Seq), metilación, célula única, anotación de genomas.', link: 'https://www.bioconductor.org/', license: 'Gratuito, Código Abierto' }
                    ],
                    commercial: [
                        { name: 'Geneious Prime', description: 'Suite de bioinformática de escritorio integrada y fácil de usar.', features: 'Clonación, diseño de primers, análisis Sanger y NGS (ensamblaje, llamada de variantes), filogenia.', link: 'https://www.geneious.com/', license: 'Comercial (Suscripción)' },
                        { name: 'QIAGEN CLC Genomics Workbench', description: 'Solución de software completa para el análisis de datos de NGS.', features: 'Ensamblaje de novo, resecuenciación, ARN-Seq, análisis de metilación. Módulos adicionales.', link: 'https://digitalinsights.qiagen.com/', license: 'Comercial (Suscripción)' },
                        { name: 'DNASTAR Lasergene', description: 'Suite modular para análisis de secuencias, genómica y proteómica.', features: 'Edición de secuencias, ensamblaje Sanger, alineamiento múltiple, análisis de proteínas.', link: 'https://www.dnastar.com/', license: 'Comercial (Suscripción)' },
                        { name: 'Illumina DRAGEN Bio-IT Platform', description: 'Plataforma de análisis secundario de NGS ultrarrápida y precisa.', features: 'Mapeo, alineamiento, llamada de variantes (germinal, somática), metilación.', link: 'https://www.illumina.com/informatics.html', license: 'Comercial' },
                        { name: 'DNAnexus Platform', description: 'Plataforma empresarial en la nube para gestión y análisis de datos genómicos.', features: 'Entorno seguro y conforme a normativas, ejecución de flujos de trabajo, herramientas de cohorte.', link: 'https://www.dnanexus.com/', license: 'Comercial (Empresarial)' },
                        { name: 'Golden Helix', description: 'Software de análisis genómico centrado en la interpretación de variantes clínicas.', features: 'Flujos de trabajo para cáncer, enfermedades raras, farmacogenómica, análisis de CNV.', link: 'https://www.goldenhelix.com/', license: 'Comercial (Suscripción)' },
                        { name: 'Basepair', description: 'Plataforma SaaS para análisis de NGS que se despliega en la propia cuenta de AWS del cliente.', features: 'Flujos de trabajo automatizados para genómica, transcriptómica y epigenómica.', link: 'https://www.basepairtech.com/', license: 'Comercial' },
                        { name: 'MacVector', description: 'Suite de análisis de secuencias completa y nativa para macOS.', features: 'Edición de secuencias, diseño de primers, alineamiento múltiple, filogenia, análisis NGS.', link: 'https://macvector.com/', license: 'Comercial' }
                    ]
                },
                proteinas: {
                    free: [
                        { name: 'NCBI BLAST', description: 'Herramienta fundamental para encontrar regiones de similitud entre secuencias.', features: 'Comparación de secuencias de nucleótidos y proteínas, cálculo de significancia estadística.', link: 'https://blast.ncbi.nlm.nih.gov/', license: 'Gratuito (Dominio Público)' },
                        { name: 'UniProt', description: 'Recurso centralizado de alta calidad de secuencias de proteínas e información funcional.', features: 'Base de datos curada (Swiss-Prot) y no curada (TrEMBL), referencias cruzadas.', link: 'https://www.uniprot.org/', license: 'Gratuito (CC-BY 4.0)' },
                        { name: 'RCSB PDB', description: 'Archivo mundial de datos estructurales 3D de macromoléculas biológicas.', features: 'Depósito, búsqueda, visualización y análisis de estructuras 3D, visor Mol*.', link: 'https://www.rcsb.org/', license: 'Gratuito' },
                        { name: 'AlphaFold DB', description: 'Base de datos de predicciones de estructuras de proteínas 3D de alta precisión.', features: 'Acceso a >200 millones de estructuras, búsqueda por secuencia, descarga de coordenadas.', link: 'https://alphafold.ebi.ac.uk/', license: 'Gratuito (CC-BY 4.0)' },
                        { name: 'ExPASy', description: 'Portal de recursos de bioinformática del SIB con herramientas y bases de datos.', features: 'Suite de herramientas para análisis de proteínas (ProtParam, SWISS-MODEL), proteómica.', link: 'https://www.expasy.org/', license: 'Gratuito (Uso académico)' },
                        { name: 'UCSF ChimeraX', description: 'Sistema de visualización y análisis molecular de próxima generación.', features: 'Visualización interactiva de alta calidad, análisis de estructuras, creación de imágenes y animaciones.', link: 'https://www.cgl.ucsf.edu/chimerax/', license: 'Gratuito (No comercial)' },
                        { name: 'Avogadro', description: 'Editor y visualizador molecular avanzado, de código abierto y multiplataforma.', features: 'Construcción y edición de moléculas, optimización de geometría, renderizado de alta calidad.', link: 'https://avogadro.cc/', license: 'Gratuito, Código Abierto (BSD)' }
                    ],
                    commercial: []
                },
                clonacion: {
                    free: [
                        { name: 'ApE (A plasmid Editor)', description: 'Editor de plásmidos gratuito y completo para Windows, Mac y Linux.', features: 'Análisis de sitios de restricción (sensible a metilación), mapas gráficos, alineamiento.', link: 'https://jorgensen.biology.utah.edu/wayned/ape/', license: 'Gratuito (Donationware)' },
                        { name: 'Serial Cloner', description: 'Software de biología molecular centrado en la clonación de ADN.', features: 'Construcción de mapas de plásmidos, PCR virtual, alineamiento, importación desde NCBI/EMBL.', link: 'http://serialbasics.free.fr/Serial_Cloner.html', license: 'Gratuito' },
                        { name: 'SnapGene Viewer', description: 'Versión gratuita de solo lectura de SnapGene para visualizar y compartir archivos.', features: 'Visualización de mapas de plásmidos y trazas de secuenciación, anotación de características.', link: 'https://www.snapgene.com/snapgene-viewer', license: 'Gratuito (Propietario)' }
                    ],
                    commercial: [
                        { name: 'SnapGene', description: 'Software líder para la planificación, visualización y documentación de clonación molecular.', features: 'Simulación de clonación (restricción, Gibson, etc.), mapas de plásmidos visualmente ricos.', link: 'https://www.snapgene.com/', license: 'Comercial (Suscripción/Perpetua)' },
                        { name: 'Benchling', description: 'Plataforma de I+D en la nube que integra ELN, LIMS y herramientas de biología molecular.', features: 'Diseño de secuencias, clonación, diseño de primers y guías CRISPR, con trazabilidad completa.', link: 'https://www.benchling.com/', license: 'Comercial (Suscripción)' },
                        { name: 'Vector NTI', description: 'Una de las primeras suites de bioinformática de escritorio integradas, muy influyente en su época. (Descontinuado)', features: 'Análisis y gestión de secuencias, diseño de plásmidos, alineamiento múltiple, diseño de primers.', link: 'https://en.wikipedia.org/wiki/Vector_NTI', license: 'Comercial (Histórico)' }
                    ]
                },
                movil: {
                    free: [
                        { name: 'DNAApp', description: 'Aplicación móvil (Android/iOS) para visualizar trazas de secuenciación Sanger (.ab1).', features: 'Visualización de cromatogramas, secuencia, puntuaciones de calidad, complemento inverso.', link: 'Google Play / App Store', license: 'Gratuito (CC BY-NC 4.0)' },
                        { name: 'BioViewer', description: 'Aplicación móvil (iOS/macOS) para la visualización 3D de estructuras de proteínas.', features: 'Renderizado 3D de alta calidad, modo foto, soporte para múltiples modelos.', link: 'App Store', license: 'Gratuito' }
                    ],
                    commercial: []
                }
            };

            function createTable(data, category) {
                let tableHTML = `
                    <div class="flex justify-end mb-4">
                        <label class="toggle-switch">
                            <input type="checkbox" id="toggle-${category}">
                            <span class="slider"></span>
                            <span class="slider-text">
                                <span>Gratuito</span>
                                <span>Comercial</span>
                            </span>
                        </label>
                    </div>
                    <div class="table-container rounded-xl">
                        <table class="min-w-full divide-y" style="border-color: rgba(129, 140, 248, 0.3);">
                            <thead style="background-color: rgba(17, 24, 39, 0.8);">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" style="color: var(--primary-glow);">Nombre</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" style="color: var(--primary-glow);">Descripción</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" style="color: var(--primary-glow);">Funcionalidades Clave</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" style="color: var(--primary-glow);">Licencia</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y" style="border-color: rgba(129, 140, 248, 0.3);">
                `;
                
                data.forEach(item => {
                    tableHTML += `
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <a href="${item.link}" target="_blank" rel="noopener noreferrer" class="font-semibold" style="color: var(--secondary); text-shadow: 0 0 5px var(--secondary-glow);">${item.name}</a>
                            </td>
                            <td class="px-6 py-4 whitespace-normal text-sm">${item.description}</td>
                            <td class="px-6 py-4 whitespace-normal text-sm">${item.features}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm" style="color: var(--primary-text);">${item.license}</td>
                        </tr>
                    `;
                });

                tableHTML += `
                            </tbody>
                        </table>
                    </div>
                `;
                return tableHTML;
            }

            function renderTable(category, type) {
                const container = document.getElementById(`table-${category}-container`);
                const data = softwareData[category][type];
                if (data && data.length > 0) {
                    container.innerHTML = createTable(data, category);
                } else {
                    container.innerHTML = `
                        <div class="flex justify-end mb-4">
                            <label class="toggle-switch">
                                <input type="checkbox" id="toggle-${category}" ${type === 'commercial' ? 'checked' : ''}>
                                <span class="slider"></span>
                                <span class="slider-text">
                                    <span>Gratuito</span>
                                    <span>Comercial</span>
                                </span>
                            </label>
                        </div>
                        <div class="p-6 rounded-xl text-center">
                            No hay herramientas ${type === 'commercial' ? 'comerciales' : 'gratuitas'} listadas en esta categoría.
                        </div>
                    `;
                }
                
                const toggle = document.getElementById(`toggle-${category}`);
                if (toggle) {
                    toggle.checked = type === 'commercial';
                    toggle.addEventListener('change', (event) => {
                        const newType = event.target.checked ? 'commercial' : 'free';
                        renderTable(category, newType);
                    });
                }
            }

            const navLinks = document.querySelectorAll('.tabs-nav-link');
            const contentSections = document.querySelectorAll('.content-section');
            let platformChartInstance, licenseChartInstance;

            function showSection(hash) {
                const targetId = hash.substring(1);
                
                contentSections.forEach(section => {
                    section.classList.remove('active');
                });
                 navLinks.forEach(link => {
                    link.classList.remove('active');
                });
                
                const activeSection = document.getElementById(targetId);
                const activeLink = document.querySelector(`.tabs-nav-link[href="${hash}"]`);

                if (activeSection) activeSection.classList.add('active');
                if (activeLink) activeLink.classList.add('active');

                if (targetId === 'dashboard') {
                    renderDashboardCharts();
                }
            }

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const href = e.target.getAttribute('href');
                    history.pushState(null, '', href);
                    showSection(href);
                });
            });
            
            window.addEventListener('popstate', () => {
                showSection(window.location.hash || '#genomico');
            });

            function renderDashboardCharts() {
                const platformCtx = document.getElementById('platformChart').getContext('2d');
                const licenseCtx = document.getElementById('licenseChart').getContext('2d');

                const desktopCount = softwareData.genomico.free.length + softwareData.genomico.commercial.length + 
                                       softwareData.proteinas.free.length + softwareData.proteinas.commercial.length +
                                       softwareData.clonacion.free.length + softwareData.clonacion.commercial.length;
                const cloudCount = 4; // DRAGEN, DNAnexus, Basepair, Benchling
                const mobileCount = softwareData.movil.free.length + softwareData.movil.commercial.length;

                const freeCount = Object.values(softwareData).reduce((sum, cat) => sum + cat.free.length, 0);
                const commercialCount = Object.values(softwareData).reduce((sum, cat) => sum + cat.commercial.length, 0);

                const chartOptions = {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: 'var(--primary-text)'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += context.parsed;
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                };

                if (platformChartInstance) platformChartInstance.destroy();
                platformChartInstance = new Chart(platformCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Escritorio', 'Nube', 'Móvil'],
                        datasets: [{
                            label: 'Distribución por Plataforma',
                            data: [desktopCount, cloudCount, mobileCount],
                            backgroundColor: ['#818cf8', '#6366f1', '#4f46e5'],
                            borderColor: 'rgba(17, 24, 39, 0.8)',
                            borderWidth: 4
                        }]
                    },
                    options: chartOptions
                });

                if (licenseChartInstance) licenseChartInstance.destroy();
                licenseChartInstance = new Chart(licenseCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Gratuito', 'Comercial'],
                        datasets: [{
                            label: 'Distribución por Licencia',
                            data: [freeCount, commercialCount],
                            backgroundColor: ['#22d3ee', '#06b6d4'],
                            borderColor: 'rgba(17, 24, 39, 0.8)',
                            borderWidth: 4
                        }]
                    },
                    options: chartOptions
                });
            }
            
            renderTable('genomico', 'free');
            renderTable('proteinas', 'free');
            renderTable('clonacion', 'free');
            renderTable('movil', 'free');

            showSection(window.location.hash || '#genomico');
        }
    </script>
</body>
</html>
